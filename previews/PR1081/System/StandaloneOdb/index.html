<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Stand alone ODB · Harmonie wiki</title><meta name="title" content="Stand alone ODB · Harmonie wiki"/><meta property="og:title" content="Stand alone ODB · Harmonie wiki"/><meta property="twitter:title" content="Stand alone ODB · Harmonie wiki"/><meta name="description" content="Documentation for Harmonie wiki."/><meta property="og:description" content="Documentation for Harmonie wiki."/><meta property="twitter:description" content="Documentation for Harmonie wiki."/><meta property="og:url" content="https://hirlam.github.io/HarmonieSystemDocumentation/dev/System/StandaloneOdb/"/><meta property="twitter:url" content="https://hirlam.github.io/HarmonieSystemDocumentation/dev/System/StandaloneOdb/"/><link rel="canonical" href="https://hirlam.github.io/HarmonieSystemDocumentation/dev/System/StandaloneOdb/"/><script async src="https://www.googletagmanager.com/gtag/js?id=G-HQ1BCP3LPJ"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HQ1BCP3LPJ', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Harmonie wiki logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Harmonie wiki</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../GitDeveloperDocumentation/">GitHub workflow</a></li><li><a class="tocitem" href="../../Overview/da_graph/">Graphical Overview</a></li><li><a class="tocitem" href="../ECMWF/RunningHarmonieOnAtos/">Running on Atos</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Overview</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Overview/Content/">Content</a></li><li><a class="tocitem" href="../../Overview/Binaries/">Binaries</a></li><li><a class="tocitem" href="../../Overview/FileFormats/">File Formats</a></li><li><a class="tocitem" href="../../Overview/Source/">Source</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Experiment Configuration</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ExperimentConfiguration/ConfigureYourExperiment/">Experiment</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/Namelists/">Namelist</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/UseofObservation/">Observations</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/PlatformConfiguration/">Platform</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/How_to_use_hires_topography/">HiRes Topography</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/ModelDomain/">Domain</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/VerticalGrid/">Vertical Grid</a></li></ul></li></ul></li><li><span class="tocitem">NWP Components</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Observations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1-1"><span class="docs-label">Preprocessing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Observations/ObservationPreprocessing/">Preprocessing</a></li><li><a class="tocitem" href="../../Observations/Oulan/">Oulan</a></li><li><a class="tocitem" href="../../Observations/Bator/">Bator</a></li><li><a class="tocitem" href="../../Observations/Cope/">Cope</a></li><li><a class="tocitem" href="../../Observations/ObservationData/">ObservationData</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Observations/SYNOP/">SYNOP</a></li><li><a class="tocitem" href="../../Observations/Amv/">AMV</a></li><li><a class="tocitem" href="../../Observations/Atovs/">ATOVS</a></li><li><a class="tocitem" href="../../Observations/Iasi/">IASI</a></li><li><a class="tocitem" href="../../Observations/Seviri/">SEVIRI</a></li><li><a class="tocitem" href="../../Observations/Scatt/">Scatt</a></li><li><a class="tocitem" href="../../Observations/Ascat/">AScat</a></li><li><a class="tocitem" href="../../Observations/GNSS/">GNSS</a></li><li><a class="tocitem" href="../../Observations/Modes/">Modes</a></li><li><a class="tocitem" href="../../Observations/RadarData/">Radar</a></li><li><a class="tocitem" href="../../Observations/Aeolus/">Aeolus</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Data Assimilation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-2-1" type="checkbox"/><label class="tocitem" for="menuitem-3-2-1"><span class="docs-label">Surface</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI/">CANARI</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI_OI_MAIN/">CANARI OI MAIN</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI_EKF_SURFEX/">CANARI EKF SURFEX</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/SurfaceAnalysis/">Surface Analysis</a></li></ul></li><li><a class="tocitem" href="../../DataAssimilation/Screening/">Screening</a></li><li><a class="tocitem" href="../../DataAssimilation/StructureFunctions/">Structure functions</a></li><li><a class="tocitem" href="../../DataAssimilation/DaAlgorithms/">Algorithms</a></li><li><a class="tocitem" href="../../DataAssimilation/DigitalFilterInitialization/">Digital Filter Initialization</a></li><li><a class="tocitem" href="../../DataAssimilation/ObservationOperators/">HOP_DRIVER</a></li><li><a class="tocitem" href="../../DataAssimilation/SingleObs/">Single Obs</a></li><li><a class="tocitem" href="../../DataAssimilation/LSMIXandJk/">LSMIX and Jk</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-3-1"><span class="docs-label">Data Assimilation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/DFS/">DFS</a></li><li><a class="tocitem" href="../../DataAssimilation/MTEN/">MTEN</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-3-2"><span class="docs-label">Forecast(spin-up)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/CHKEVO/">CHKEVO</a></li><li><a class="tocitem" href="../../DataAssimilation/NWECHKEVO/">NWECHKEVO</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Boundaries</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Boundaries/BoundaryFilePreparation/">Preparation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Forecast Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ForecastModel/Forecast/">Forecast</a></li><li><a class="tocitem" href="../../ForecastModel/ForecastSettings/">Settings</a></li><li><a class="tocitem" href="../../ForecastModel/Outputlist/">Output List</a></li><li><a class="tocitem" href="../../ForecastModel/HR/">High Res</a></li><li><input class="collapse-toggle" id="menuitem-3-5-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5-5"><span class="docs-label">Single Column Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC/">MUSC</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/Forcing/">Forcing</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC_EMS/">MUSC EMS</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC_vars/">MUSC vars</a></li></ul></li><li><a class="tocitem" href="../../ForecastModel/WindFarms/">Wind Farm Parameterisation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Climate Generation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ClimateGeneration/ClimateGeneration/">Climate Generation</a></li><li><a class="tocitem" href="../../ClimateGeneration/DownloadInputData/">Input Data</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">EPS</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../EPS/Howto/">Howto</a></li><li><a class="tocitem" href="../../EPS/System/">System</a></li><li><a class="tocitem" href="../../EPS/BDSTRATEGY/">BDSTRATEGY</a></li><li><a class="tocitem" href="../../EPS/SLAF/">SLAF</a></li><li><a class="tocitem" href="../../EPS/SPP/">SPP</a></li><li><a class="tocitem" href="../../EPS/SPPT/">SPPT</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-8" type="checkbox"/><label class="tocitem" for="menuitem-3-8"><span class="docs-label">Post Processing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../PostProcessing/Diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../../PostProcessing/FileConversions/">FileConversions</a></li><li><a class="tocitem" href="../../PostProcessing/Fullpos/">FullPos</a></li><li><a class="tocitem" href="../../PostProcessing/gl/">GL</a></li><li><a class="tocitem" href="../../PostProcessing/xtool/">xtool</a></li><li><a class="tocitem" href="../../PostProcessing/Interpolation/">Interpolation GL</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-9" type="checkbox"/><label class="tocitem" for="menuitem-3-9"><span class="docs-label">Verification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Verification/Extract4verification/">Extract4verification</a></li><li><a class="tocitem" href="../../Verification/Verification/">Verification</a></li><li><a class="tocitem" href="../../Verification/AllobsVerification/">allobs Verification</a></li><li><a class="tocitem" href="../../Verification/HARP/">HARP</a></li><li><a class="tocitem" href="../../Verification/Obsmon/">Obsmon</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-10" type="checkbox"/><label class="tocitem" for="menuitem-3-10"><span class="docs-label">Visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Visualization/EPyGrAM/">EpyGram</a></li></ul></li></ul></li><li><span class="tocitem">System</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Build</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Build/Build_with_cmake/">CMake</a></li><li><a class="tocitem" href="../../Build/Build_with_makeup/">Makeup</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Phasing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../MFaccess/">MF Access</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Suite Management</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../SuiteManagement/ECFLOW/">ECFLOW</a></li></ul></li><li><a class="tocitem" href="../TheHarmonieScript/">The Harmonie script</a></li><li><a class="tocitem" href="../ECMWF/RunningHarmonieOnAtos/">Running on ECMWF&#39;s Atos</a></li><li><a class="tocitem" href="../ReleaseProcess/">Harmonie release process</a></li><li><a class="tocitem" href="../Local/QuickStartLocal/">Local</a></li><li><a class="tocitem" href="../HarmonieTestbed/">Testbed</a></li><li><a class="tocitem" href="../ECMWF/ECMWF_teleport/">Teleport</a></li><li><a class="tocitem" href="../Build_local_docs/">Local Documentation</a></li><li><a class="tocitem" href="../DrHook/">DrHook</a></li><li class="is-active"><a class="tocitem" href>Stand alone ODB</a><ul class="internal"><li><a class="tocitem" href="#Get-the-software"><span>Get the software</span></a></li><li><a class="tocitem" href="#Building-your-ODB-software"><span>Building your ODB software</span></a></li><li class="toplevel"><a class="tocitem" href="#ACTION:-FOR-EOIN:-everything-below-here-needs-to-be-updated"><span>ACTION: FOR EOIN: everything below here needs to be updated</span></a></li><li class="toplevel"><a class="tocitem" href="#ODB-data"><span>ODB data</span></a></li><li><a class="tocitem" href="#Convert-ODB-1-to-ODB-2"><span>Convert ODB-1 to ODB-2</span></a></li><li><a class="tocitem" href="#Instructions-for-use-on-ecgb"><span>Instructions for use on ecgb</span></a></li><li class="toplevel"><a class="tocitem" href="#ODB-visualisation"><span>ODB visualisation</span></a></li></ul></li><li><a class="tocitem" href="../UpdateNamelists/">Update Namelist</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">System</a></li><li class="is-active"><a href>Stand alone ODB</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Stand alone ODB</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Hirlam/Harmonie" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Hirlam/Harmonie/blob/dev-CY46h1/docs/src/System/StandaloneOdb.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ODB-software"><a class="docs-heading-anchor" href="#ODB-software">ODB software</a><a id="ODB-software-1"></a><a class="docs-heading-anchor-permalink" href="#ODB-software" title="Permalink"></a></h1><h2 id="Get-the-software"><a class="docs-heading-anchor" href="#Get-the-software">Get the software</a><a id="Get-the-software-1"></a><a class="docs-heading-anchor-permalink" href="#Get-the-software" title="Permalink"></a></h2><p>To make best use of ODB information produced by your Harmonie experiment one should use ODB and ODB-API software developed by ECMWF. Below are instruction on how to obtain the software from ECMWF.</p><h3 id="ODB-API"><a class="docs-heading-anchor" href="#ODB-API">ODB-API</a><a id="ODB-API-1"></a><a class="docs-heading-anchor-permalink" href="#ODB-API" title="Permalink"></a></h3><p><a href="https://confluence.ecmwf.int/display/ODBAPI">ODB-API</a> software is open source and released under an Apache licence</p><h3 id="ODB"><a class="docs-heading-anchor" href="#ODB">ODB</a><a id="ODB-1"></a><a class="docs-heading-anchor-permalink" href="#ODB" title="Permalink"></a></h3><p><em>ODB stands for Observational !DataBase. It is database software to store and retrieve large amounts of meteorological numerical data in an efficient manner while used from within IFS. ODB software mimics relational database queries through its ODB/SQL -compiler and accesses data currently via a Fortran90 library interface.</em> The original documentation is available <a href="https://www.ecmwf.int/sites/default/files/elibrary/2004/76278-ifs-documentation-cy36r1-part-i-observation-processing_1.pdf">here</a></p><h2 id="Building-your-ODB-software"><a class="docs-heading-anchor" href="#Building-your-ODB-software">Building your ODB software</a><a id="Building-your-ODB-software-1"></a><a class="docs-heading-anchor-permalink" href="#Building-your-ODB-software" title="Permalink"></a></h2><p>The ODB-API Software bundle uses cmake <a href="https://cmake.org/">https://www.cmake.org</a> to configure the make files used to compile the software. The instructions below worked with Redhat 7/GCC 4.8.5 and CentOS 7/GCC 4.8.5. On newer systems python functionality may have to be switched off with -DENABLE_PYTHON=OFF.</p><pre><code class="language-bash hljs">VERSION=0.18.1
wget https://confluence.ecmwf.int/download/attachments/61117379/odb_api_bundle-${VERSION}-Source.tar.gz
gunzip odb_api_bundle-${VERSION}-Source.tar.gz
tar -xvf odb_api_bundle-${VERSION}-Source.tar
cd odb_api_bundle-${VERSION}-Source
mkdir build
cd build
cmake.. -DCMAKE_INSTALL_PREFIX=/opt/metapp/odb_api/${VERSION}/gnu \
-DENABLE_ODB_API_SERVER_SIDE=ON -DENABLE_FORTRAN=ON \
-DENABLE_GRIB=OFF -DENABLE_ODB_SERVER_TIME_FORMAT_FOUR_DIGITS=ON \
-DENABLE_PYTHON=ON -DENABLE_ODB=ON -DODB_SCHEMAS=&quot;ECMA;CCMA&quot;
make -j 2
ctest
make install</code></pre><h3 id="Building-on-Fedora-systems"><a class="docs-heading-anchor" href="#Building-on-Fedora-systems">Building on Fedora systems</a><a id="Building-on-Fedora-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Building-on-Fedora-systems" title="Permalink"></a></h3><p>To compile the <code>odb_api</code> on a Fedora workstation (F35), the following additional flags needed to be added to the cmake command above:</p><pre><code class="language-bash hljs">-DCMAKE_Fortran_FLAGS=&#39;-fallow-argument-mismatch&#39;</code></pre><p>Additionally the following flag may be needed (on F36):</p><pre><code class="language-bash hljs">-DCMAKE_SHARED_LINKER_FLAGS=&#39;-lgfortran&#39;</code></pre><p>Furthermore, compilation failed in <code>odb_api_bundle-0.18.1-Source/odb_api/src/odb_api/sqly.y</code> (<code>error: &#39;yyscan_t&#39; was not declared in this scope</code>). This can be fixed with:</p><pre><code class="language-bash hljs">sed -i &#39;6i %code requires {typedef void *yyscan_t;}&#39; odb_api_bundle-${VERSION}-Source/odb_api/src/odb_api/sqly.y</code></pre><p>So, from start to finish:</p><pre><code class="language-bash hljs">VERSION=0.18.1
wget https://confluence.ecmwf.int/download/attachments/61117379/odb_api_bundle-${VERSION}-Source.tar.gz
tar xvfz odb_api_bundle-${VERSION}-Source.tar.gz
sed -i &#39;6i %code requires {typedef void *yyscan_t;}&#39; odb_api_bundle-${VERSION}-Source/odb_api/src/odb_api/sqly.y
mkdir build
cd build
cmake ../odb_api_bundle-${VERSION}-Source -DCMAKE_INSTALL_PREFIX=$HOME/install/odb_api/${VERSION}/gnu \
 -DCMAKE_Fortran_FLAGS=&#39;-fallow-argument-mismatch&#39; \
[-DCMAKE_SHARED_LINKER_FLAGS=&#39;-lgfortran&#39; \]
 -DENABLE_ODB_API_SERVER_SIDE=ON -DENABLE_FORTRAN=ON \
 -DENABLE_GRIB=OFF -DENABLE_ODB_SERVER_TIME_FORMAT_FOUR_DIGITS=ON \
 -DENABLE_PYTHON=OFF -DENABLE_ODB=ON -DODB_SCHEMAS=&quot;ECMA;CCMA&quot;
make -j 4
ctest
make install</code></pre><h1 id="ACTION:-FOR-EOIN:-everything-below-here-needs-to-be-updated"><a class="docs-heading-anchor" href="#ACTION:-FOR-EOIN:-everything-below-here-needs-to-be-updated">ACTION: FOR EOIN: everything below here needs to be updated</a><a id="ACTION:-FOR-EOIN:-everything-below-here-needs-to-be-updated-1"></a><a class="docs-heading-anchor-permalink" href="#ACTION:-FOR-EOIN:-everything-below-here-needs-to-be-updated" title="Permalink"></a></h1><h1 id="ODB-data"><a class="docs-heading-anchor" href="#ODB-data">ODB data</a><a id="ODB-data-1"></a><a class="docs-heading-anchor-permalink" href="#ODB-data" title="Permalink"></a></h1><h2 id="Convert-ODB-1-to-ODB-2"><a class="docs-heading-anchor" href="#Convert-ODB-1-to-ODB-2">Convert ODB-1 to ODB-2</a><a id="Convert-ODB-1-to-ODB-2-1"></a><a class="docs-heading-anchor-permalink" href="#Convert-ODB-1-to-ODB-2" title="Permalink"></a></h2><p>Details on how to convert your ODB-1 (Harmonie experiment) databases to ODB-2 using odb_migrator are described here. I have used version 0.9.31 of ODB-API (I have had some problems with 0.9.32). I will use a Harmonie CCMA conventional ODB-1 database as an example:</p><pre><code class="language-bash hljs">tar -xvf odb_ccma.tar
cd odb_ccma/CCMA/
dcagen
cd ../../
ls -l ../conv.38h1.sql
which odb_migrator
/opt/metlib/odb_api/0.9.31/gnu/bin/odb_migrator -addcolumns &quot;expver=&#39;    38h1&#39;,class=2,stream=1025,type=264&quot; odb_ccma/CCMA ../conv.38h1.sql var${DTG}.odb
ls -l var${DTG}.odb</code></pre><p>Here is the SQL file used: <a href="https://hirlam.org/trac/attachment/wiki/HarmonieSystemDocumentation/StandaloneOdb/conv.38h1.sql">conv.38h1.sql</a>. To construct my conv.38h1.sql file did carried out the following commands:</p><pre><code class="language-bash hljs">cd odb_ccma/CCMA/
odbsql -q &quot;select * from desc,timeslot_index,hdr,body&quot; | head -1 </code></pre><h2 id="Instructions-for-use-on-ecgb"><a class="docs-heading-anchor" href="#Instructions-for-use-on-ecgb">Instructions for use on ecgb</a><a id="Instructions-for-use-on-ecgb-1"></a><a class="docs-heading-anchor-permalink" href="#Instructions-for-use-on-ecgb" title="Permalink"></a></h2><p>On ecgb I have installed <em>odb_migrator</em> in my own account. ODB developers have promise to provide a &quot;system&quot; installation of odb<em>migrator soon. The next version of ODB-API on ecgb should include *odb</em>migrator*. My installation is here:</p><pre><code class="language-bash hljs">/home/ms/ie/dui/odbapi/0.9.31</code></pre><p>To produce your own ODB-2 file from a Harmonie CCMA tar ball on ecgb:</p><pre><code class="language-bash hljs">module load odb
export PATH=/home/ms/ie/dui/odbapi/0.9.31/bin:$PATH
export LD_LIBRARY_PATH=/home/ms/ie/dui/odbapi/0.9.31/lib:$LD_LIBRARY_PATH
cd $SCRATCH
mkdir ODB2odb
cd ODB2odb
## copy your odb_stuff.tar/odb_ccma.tar file from ECFS/your home system to this directory
## eg -- ecp ec:/dui/harmonie/refSonde38h1p1/2013/12/27/00/odb_stuff.tar .
tar -xvf odb_stuff.tar
tar -xvf odb_ccma.tar
cd odb_ccma/CCMA/
dcagen
cd ../../
odb_migrator odb_ccma/CCMA -addcolumns &quot;expver=&#39;refSonde&#39;,class=2,stream=1025,type=264&quot; /home/ms/ie/dui/odbapi/conv.38h1.sql conv2013122700.odb
odb header conv2013122700.odb
odb sql &#39;select distinct varno&#39; -i conv2013122700.odb
odb sql &#39;select count(*) where varno=2&#39; -i conv2013122700.odb
#
rm -f bdstrategy odb*.tar ## tidy up the directory if you wish
rm -rf odb_ccma</code></pre><h1 id="ODB-visualisation"><a class="docs-heading-anchor" href="#ODB-visualisation">ODB visualisation</a><a id="ODB-visualisation-1"></a><a class="docs-heading-anchor-permalink" href="#ODB-visualisation" title="Permalink"></a></h1><p>ODB-2 data can be visualized (directly) using Metview. On local platforms Metview must be built with ODB support (that uses ODB-API software) to visualize ODB-2 data. Here is an example, odbmap.mv4, of using Metview on ecagte to visualize ODB-2 data using a Metview Macro. This example requires an ODB-2 data file as input. Optionally this macro can also plot domain grid-points from a Harmonie GRIB file (called dom.grib) to indicate the extent of your Harmonie model domain.</p><ul><li>Usage:<pre><code class="language-bash hljs">odbmap:: Usage: metview -b odbmap.mv4 inputfile odbvar odbrequest odblegend outputtype
odbmap::   where: inputfile  -- ODB-2 file
odbmap::   where: odbvar     -- ODB variable to be plotted
odbmap::                     -- (enclosed with inverted commas)
odbmap::   where: odbrequest -- ODB SQL request 
odbmap::                     -- (enclosed with inverted commas)
odbmap::   where: odblegend  -- legon/legoff
odbmap::   where: outputtype -- ps/png</code></pre></li><li>An example to plot 2m temperature observation values on 25th December 2013 at 12z:<pre><code class="language-bash hljs">cd  $SCRATCH
cp -r /home/ms/ie/dui/odbMacroTest .
cd odbMacroTest
metview4 -b odbmap.mv4 conv201312.odb &quot;obsvalue&quot; &quot;andate=20131225 and antime=120000 and varno=39&quot; legon png
xv odbmap.1.png</code></pre></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../DrHook/">« DrHook</a><a class="docs-footer-nextpage" href="../UpdateNamelists/">Update Namelist »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Friday 21 June 2024 12:14">Friday 21 June 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
