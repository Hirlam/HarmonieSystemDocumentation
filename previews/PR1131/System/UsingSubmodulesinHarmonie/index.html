<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GitHub workflow with submodules · Harmonie wiki</title><meta name="title" content="GitHub workflow with submodules · Harmonie wiki"/><meta property="og:title" content="GitHub workflow with submodules · Harmonie wiki"/><meta property="twitter:title" content="GitHub workflow with submodules · Harmonie wiki"/><meta name="description" content="Documentation for Harmonie wiki."/><meta property="og:description" content="Documentation for Harmonie wiki."/><meta property="twitter:description" content="Documentation for Harmonie wiki."/><meta property="og:url" content="https://hirlam.github.io/HarmonieSystemDocumentation/dev/System/UsingSubmodulesinHarmonie/"/><meta property="twitter:url" content="https://hirlam.github.io/HarmonieSystemDocumentation/dev/System/UsingSubmodulesinHarmonie/"/><link rel="canonical" href="https://hirlam.github.io/HarmonieSystemDocumentation/dev/System/UsingSubmodulesinHarmonie/"/><script async src="https://www.googletagmanager.com/gtag/js?id=G-HQ1BCP3LPJ"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HQ1BCP3LPJ', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Harmonie wiki logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Harmonie wiki</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../GitDeveloperDocumentation/">GitHub workflow</a></li><li class="is-active"><a class="tocitem" href>GitHub workflow with submodules</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Preparation"><span>Preparation</span></a></li><li><a class="tocitem" href="#For-users-of-Harmonie-(no-development)"><span>For users of Harmonie (no development)</span></a></li><li><a class="tocitem" href="#For-developers"><span>For developers</span></a></li><li><a class="tocitem" href="#For-developers-2"><span>For developers++</span></a></li><li><a class="tocitem" href="#More-info"><span>More info</span></a></li></ul></li><li><a class="tocitem" href="../../Overview/da_graph/">Graphical Overview</a></li><li><a class="tocitem" href="../ECMWF/RunningHarmonieOnAtos/">Running on Atos</a></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Overview</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Overview/Content/">Content</a></li><li><a class="tocitem" href="../../Overview/Binaries/">Binaries</a></li><li><a class="tocitem" href="../../Overview/FileFormats/">File Formats</a></li><li><a class="tocitem" href="../../Overview/Source/">Source</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Experiment Configuration</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ExperimentConfiguration/ConfigureYourExperiment/">Experiment</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/Namelists/">Namelist</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/UseofObservation/">Observations</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/PlatformConfiguration/">Platform</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/How_to_use_hires_topography/">HiRes Topography</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/ModelDomain/">Domain</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/VerticalGrid/">Vertical Grid</a></li></ul></li></ul></li><li><span class="tocitem">NWP Components</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Observations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1-1"><span class="docs-label">Preprocessing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Observations/ObservationPreprocessing/">Preprocessing</a></li><li><a class="tocitem" href="../../Observations/Oulan/">Oulan</a></li><li><a class="tocitem" href="../../Observations/Bator/">Bator</a></li><li><a class="tocitem" href="../../Observations/Cope/">Cope</a></li><li><a class="tocitem" href="../../Observations/ObservationData/">ObservationData</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Observations/SYNOP/">SYNOP</a></li><li><a class="tocitem" href="../../Observations/Amv/">AMV</a></li><li><a class="tocitem" href="../../Observations/Atovs/">ATOVS</a></li><li><a class="tocitem" href="../../Observations/Iasi/">IASI</a></li><li><a class="tocitem" href="../../Observations/Seviri/">SEVIRI</a></li><li><a class="tocitem" href="../../Observations/Scatt/">Scatt</a></li><li><a class="tocitem" href="../../Observations/Ascat/">AScat</a></li><li><a class="tocitem" href="../../Observations/GNSS/">GNSS</a></li><li><a class="tocitem" href="../../Observations/Modes/">Modes</a></li><li><a class="tocitem" href="../../Observations/RadarData/">Radar</a></li><li><a class="tocitem" href="../../Observations/Aeolus/">Aeolus</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Data Assimilation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-2-1" type="checkbox"/><label class="tocitem" for="menuitem-3-2-1"><span class="docs-label">Surface</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI/">CANARI</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI_OI_MAIN/">CANARI OI MAIN</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI_EKF_SURFEX/">CANARI EKF SURFEX</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/SurfaceAnalysis/">Surface Analysis</a></li></ul></li><li><a class="tocitem" href="../../DataAssimilation/Screening/">Screening</a></li><li><a class="tocitem" href="../../DataAssimilation/StructureFunctions/">Structure functions</a></li><li><a class="tocitem" href="../../DataAssimilation/DaAlgorithms/">Algorithms</a></li><li><a class="tocitem" href="../../DataAssimilation/DigitalFilterInitialization/">Digital Filter Initialization</a></li><li><a class="tocitem" href="../../DataAssimilation/ObservationOperators/">HOP_DRIVER</a></li><li><a class="tocitem" href="../../DataAssimilation/SingleObs/">Single Obs</a></li><li><a class="tocitem" href="../../DataAssimilation/LSMIXandJk/">LSMIX and Jk</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-3-1"><span class="docs-label">Data Assimilation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/DFS/">DFS</a></li><li><a class="tocitem" href="../../DataAssimilation/MTEN/">MTEN</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-3-2"><span class="docs-label">Forecast(spin-up)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/CHKEVO/">CHKEVO</a></li><li><a class="tocitem" href="../../DataAssimilation/NWECHKEVO/">NWECHKEVO</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Boundaries</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Boundaries/BoundaryFilePreparation/">Preparation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Forecast Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ForecastModel/Forecast/">Forecast</a></li><li><a class="tocitem" href="../../ForecastModel/ForecastSettings/">Settings</a></li><li><a class="tocitem" href="../../ForecastModel/Outputlist/">Output List</a></li><li><a class="tocitem" href="../../ForecastModel/HR/">High Res</a></li><li><input class="collapse-toggle" id="menuitem-3-5-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5-5"><span class="docs-label">Single Column Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC/">MUSC</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/Forcing/">Forcing</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC_EMS/">MUSC EMS</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC_vars/">MUSC vars</a></li></ul></li><li><a class="tocitem" href="../../ForecastModel/WindFarms/">Wind Farm Parameterisation</a></li><li><a class="tocitem" href="../../ForecastModel/DDH/">Use of DDH</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Climate Generation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ClimateGeneration/ClimateGeneration/">Climate Generation</a></li><li><a class="tocitem" href="../../ClimateGeneration/DownloadInputData/">Input Data</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">EPS</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../EPS/Howto/">Howto</a></li><li><a class="tocitem" href="../../EPS/System/">System</a></li><li><a class="tocitem" href="../../EPS/BDSTRATEGY/">BDSTRATEGY</a></li><li><a class="tocitem" href="../../EPS/SLAF/">SLAF</a></li><li><a class="tocitem" href="../../EPS/SPP/">SPP</a></li><li><a class="tocitem" href="../../EPS/SPPT/">SPPT</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-8" type="checkbox"/><label class="tocitem" for="menuitem-3-8"><span class="docs-label">Post Processing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../PostProcessing/Diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../../PostProcessing/FileConversions/">FileConversions</a></li><li><a class="tocitem" href="../../PostProcessing/Fullpos/">FullPos</a></li><li><a class="tocitem" href="../../PostProcessing/gl/">GL</a></li><li><a class="tocitem" href="../../PostProcessing/xtool/">xtool</a></li><li><a class="tocitem" href="../../PostProcessing/Interpolation/">Interpolation GL</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-9" type="checkbox"/><label class="tocitem" for="menuitem-3-9"><span class="docs-label">Verification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Verification/Extract4verification/">Extract4verification</a></li><li><a class="tocitem" href="../../Verification/Verification/">Verification</a></li><li><a class="tocitem" href="../../Verification/AllobsVerification/">allobs Verification</a></li><li><a class="tocitem" href="../../Verification/HARP/">HARP</a></li><li><a class="tocitem" href="../../Verification/Obsmon/">Obsmon</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-10" type="checkbox"/><label class="tocitem" for="menuitem-3-10"><span class="docs-label">Visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Visualization/EPyGrAM/">EpyGram</a></li></ul></li></ul></li><li><span class="tocitem">System</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Build</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Build/Build_with_cmake/">CMake</a></li><li><a class="tocitem" href="../../Build/Build_with_makeup/">Makeup</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Phasing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../MFaccess/">MF Access</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Suite Management</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../SuiteManagement/ECFLOW/">ECFLOW</a></li></ul></li><li><a class="tocitem" href="../TheHarmonieScript/">The Harmonie script</a></li><li><a class="tocitem" href="../ECMWF/RunningHarmonieOnAtos/">Running on ECMWF&#39;s Atos</a></li><li><a class="tocitem" href="../ReleaseProcess/">Harmonie release process</a></li><li><a class="tocitem" href="../Local/QuickStartLocal/">Local</a></li><li><a class="tocitem" href="../HarmonieTestbed/">Testbed</a></li><li><a class="tocitem" href="../ECMWF/ECMWF_teleport/">Teleport</a></li><li><a class="tocitem" href="../Build_local_docs/">Local Documentation</a></li><li><a class="tocitem" href="../DrHook/">DrHook</a></li><li><a class="tocitem" href="../StandaloneOdb/">Stand alone ODB</a></li><li><a class="tocitem" href="../UpdateNamelists/">Update Namelist</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Getting Started</a></li><li class="is-active"><a href>GitHub workflow with submodules</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>GitHub workflow with submodules</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Hirlam/Harmonie" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Hirlam/Harmonie/blob/dev-CY46h1/docs/src/System/UsingSubmodulesinHarmonie.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="git-submodules-in-harmonie"><a class="docs-heading-anchor" href="#git-submodules-in-harmonie">How to use submodules in the HarmonieCSC repository</a><a id="git-submodules-in-harmonie-1"></a><a class="docs-heading-anchor-permalink" href="#git-submodules-in-harmonie" title="Permalink"></a></h1><p><em><strong>The information on this page is not relevant for CY46 yet, but is intended as pointer to upcoming changes in CY49 and might be useful when porting changes from CY46 to CY49</strong></em></p><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Up to CY49 the <a href="https://github.com/Hirlam/Harmonie">Hirlam/Harmonie</a> repository contained all scripts and code needed for Harmonie and then some. Since CY49 a new <a href="https://github.com/Hirlam/HarmonieCSC">Hirlam/HarmonieCSC</a> repository is used. The <code>src</code> directory has been externalized so it can follow the ACCORD IAL repository, simplifying code development within ACCORD. In addition to the <code>src</code> directory, several other components have been moved into separate repositories outside the Harmonie repository as well. To create a consistent set of scripts, code and tools, git submodules are used. Git submodules are essentially git repositories contained within the main repository, a.k.a. the <em>superproject</em>, with commit hashes of the submodules tied to a specific commit of the superproject. The <a href="https://github.com/Hirlam/HarmonieCSC">Hirlam/HarmonieCSC</a> superproject contains the following submodules:</p><ul><li><code>const</code> –&gt; <a href="https://github.com/Hirlam/HarmonieConst">Hirlam/HarmonieConst</a></li><li><code>src</code> –&gt; <a href="https://github.com/Hirlam/IAL">Hirlam/IAL</a></li><li><code>util/auxlibs</code> –&gt; <a href="https://github.com/Hirlam/Auxlibs">Hirlam/Auxlibs</a></li><li><code>util/gl</code> –&gt; <a href="https://github.com/Hirlam/GL">Hirlam/GL</a></li></ul><hr/><h2 id="Preparation"><a class="docs-heading-anchor" href="#Preparation">Preparation</a><a id="Preparation-1"></a><a class="docs-heading-anchor-permalink" href="#Preparation" title="Permalink"></a></h2><p>To be able to access github using ssh, add your public ssh key to https://github.com/settings/keys</p><h2 id="For-users-of-Harmonie-(no-development)"><a class="docs-heading-anchor" href="#For-users-of-Harmonie-(no-development)">For users of Harmonie (no development)</a><a id="For-users-of-Harmonie-(no-development)-1"></a><a class="docs-heading-anchor-permalink" href="#For-users-of-Harmonie-(no-development)" title="Permalink"></a></h2><p>Clone the Harmonie superproject + the submodules contained therein from the Hirlam organization:</p><pre><code class="language-bash hljs">git clone --recurse-submodules git@github.com:Hirlam/HarmonieCSC.git</code></pre><p>This will create a structure very similar to the original Harmonie repository and usage is as before. </p><p>If you forget the <code>--recurse-submodules</code>, you can use:</p><pre><code class="language-bash hljs">git submodule init</code></pre><p>To initialise your submodules after cloning followed by a recursive pull described below.</p><h3 id="Pull-changes-to-your-local-repository"><a class="docs-heading-anchor" href="#Pull-changes-to-your-local-repository">Pull changes to your local repository</a><a id="Pull-changes-to-your-local-repository-1"></a><a class="docs-heading-anchor-permalink" href="#Pull-changes-to-your-local-repository" title="Permalink"></a></h3><p>If a submodule has changed remotely, the reference in the superproject will also have changed and you can get the change with a pull. After pulling, you can update your submodules with:</p><pre><code class="language-bash hljs">git submodule update</code></pre><p>This can be done with one command with:</p><pre><code class="language-bash hljs">git pull --recurse-submodules</code></pre><p>This can be set to the default behaviour by setting:</p><pre><code class="language-bash hljs">git config --global submodule.recurse true</code></pre><p>However, this will check out the commit set in the superproject in all your submodules, so if you are working on your own branch, you will have to check it out again afterwards manually. If you have uncommited changes in your branch, you will get an error and the checkout will be aborted.</p><p>To avoid this, you can use:</p><pre><code class="language-bash hljs">git submodule update path/to/submodule</code></pre><p>to update a specific submodule.</p><hr/><h2 id="For-developers"><a class="docs-heading-anchor" href="#For-developers">For developers</a><a id="For-developers-1"></a><a class="docs-heading-anchor-permalink" href="#For-developers" title="Permalink"></a></h2><p>Contributing code has become somewhat more complex, as the submodules and the superproject need to be treated separately. The steps that need to be taken are described below for 3 scenarios.</p><h3 id="Creating-user-forks"><a class="docs-heading-anchor" href="#Creating-user-forks">Creating user forks</a><a id="Creating-user-forks-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-user-forks" title="Permalink"></a></h3><p>To be able to create pull requests a user fork of the superproject is needed. This can be done via https://github.com/Hirlam/HarmonieCSC/fork. To contribute to one or more of the submodules, forks must be created for these as well in a similar fashion, <em>e.g.</em> from <code>src</code> via https://github.com/Hirlam/IAL/fork.   User forks need to be kept up-to-date manually by the users themselves (see <a href="../GitDeveloperDocumentation/#git-developer-documentation">GitDeveloperDocumentation</a>). Alternatively, you can clone the superproject from <code>Hirlam</code> and add your user fork as a second remote:</p><ul><li>Clone the superproject + the submodules contained therein from the Hirlam organization, and move into it (Note that the remote will be called <code>Hirlam</code>, rather than <code>origin</code>):<pre><code class="language-bash hljs">git clone -o Hirlam --recurse-submodules git@github.com:Hirlam/HarmonieCSC.git
cd HarmonieCSC</code></pre></li><li>Then add your user fork as new remote and update all remotes<pre><code class="language-bash hljs">git remote add &lt;YOUR_GITHUB_USERNAME&gt; git@github.com:&lt;YOUR_GITHUB_USERNAME&gt;/HarmonieCSC
git fetch --all</code></pre></li><li>After making changes, push to your fork, not to <code>Hirlam</code>.</li></ul><h3 id="Scenario-1:-Modify-the-superproject-only"><a class="docs-heading-anchor" href="#Scenario-1:-Modify-the-superproject-only">Scenario 1: Modify the superproject only</a><a id="Scenario-1:-Modify-the-superproject-only-1"></a><a class="docs-heading-anchor-permalink" href="#Scenario-1:-Modify-the-superproject-only" title="Permalink"></a></h3><p>If only modifications to the superproject are needed, the workflow is very similar to before, as there is no need to update the submodules and their hashes.</p><p>Create a new feature or bugfix branch for the new development, e.g.:</p><pre><code class="language-bash hljs">git checkout -b &lt;YOUR_BRANCH&gt; [branch_to_branch_from]</code></pre><p>This will create a new branch named <code>&lt;YOUR_BRANCH&gt;</code> based on the branch that was checked out, or from the branch specified as <code>[branch_to_branch_from]</code>.   to create and check out the branch in a different location without copying the full repository, worktrees can be used, e.g.:</p><pre><code class="language-bash hljs">git worktree add -b &lt;YOUR_BRANCH&gt; ../some_new_dev [branch_to_branch_from]</code></pre><p>Which will create new branch <code>&lt;YOUR_BRANCH&gt;</code> and check it out in <code>../some_new_dev</code></p><p>Make the changes as needed, then stage and commit them:</p><pre><code class="language-bash hljs">git add &lt;changed_files&gt;         # stage
git commit -m &quot;Useful message&quot;  # and commit</code></pre><p>Then push the changes in your branch to your fork:</p><pre><code class="language-bash hljs">git push -u &lt;YOUR_GITHUB_USERNAME&gt; &lt;YOUR_BRANCH&gt;</code></pre><p>Once you are happy, create a pull request in github.</p><h3 id="Scenario-2:-Modify-a-submodule-only"><a class="docs-heading-anchor" href="#Scenario-2:-Modify-a-submodule-only">Scenario 2: Modify a submodule only</a><a id="Scenario-2:-Modify-a-submodule-only-1"></a><a class="docs-heading-anchor-permalink" href="#Scenario-2:-Modify-a-submodule-only" title="Permalink"></a></h3><p>If only a change in the submodules is needed, first the change in the submodule needs to be made and merged, and then the submodule&#39;s hash in the superproject needs to be updated so that it points to the new commit.   Basic steps are:  </p><ul><li>Make the desired changes to the submodule:<ul><li>Clone your user fork</li><li>Go to the submodule directory and add your fork of the submodule as remote</li><li>Create a new branch for the submodule</li><li>Make and test your changes to the submodule</li><li>Commit the changes to the submodule</li><li>Push the submodule changes to your user fork of the submodule on github</li><li>Create a pull request for the submodule changes and wait until they are approved and merged in</li></ul></li><li>Update the submodule&#39;s hash in the superproject:  <ul><li>Go to the superproject clone directory</li><li>Create a new branch</li><li>Update the submodule&#39;s hash and commit the change</li><li>Push the new branch to your user fork of the superproject</li><li>Create a pull request to update the submodule&#39;s hash</li></ul></li></ul><p>See next section for details from a real case.</p><h4 id="Steps-taken-in-a-real-case,-modifying-src/surfex/SURFEX/interpol_npts.F90"><a class="docs-heading-anchor" href="#Steps-taken-in-a-real-case,-modifying-src/surfex/SURFEX/interpol_npts.F90">Steps taken in a real case, modifying src/surfex/SURFEX/interpol_npts.F90</a><a id="Steps-taken-in-a-real-case,-modifying-src/surfex/SURFEX/interpol_npts.F90-1"></a><a class="docs-heading-anchor-permalink" href="#Steps-taken-in-a-real-case,-modifying-src/surfex/SURFEX/interpol_npts.F90" title="Permalink"></a></h4><ul><li><p>Clone your up-to-date fork</p><pre><code class="language-bash hljs">&gt; cd &lt;SOMEPATH&gt;
&gt; git clone --recurse-submodules git@github.com:&lt;YOUR_GITHUB_USERNAME&gt;/HarmonieCSC.git
Cloning into &#39;HarmonieCSC&#39;...
remote: Enumerating objects: 25230, done.
remote: Counting objects: 100% (277/277), done.
remote: Compressing objects: 100% (154/154), done.
remote: Total 25230 (delta 156), reused 198 (delta 120), pack-reused 24953
Receiving objects: 100% (25230/25230), 8.28 MiB | 2.91 MiB/s, done.
Resolving deltas: 100% (18952/18952), done.
Updating files: 100% (1395/1395), done.
Submodule &#39;const&#39; (git@github.com:Hirlam/HarmonieConst) registered for path &#39;const&#39;
Submodule &#39;src&#39; (git@github.com:Hirlam/IAL.git) registered for path &#39;src&#39;
Submodule &#39;util/auxlibs&#39; (git@github.com:Hirlam/Auxlibs.git) registered for path &#39;util/auxlibs&#39;
Submodule &#39;util/gl&#39; (git@github.com:Hirlam/GL.git) registered for path &#39;util/gl&#39;
Cloning into &#39;&lt;SOMEPATH&gt;/HarmonieCSC/const&#39;...
remote: Enumerating objects: 535, done.        
remote: Total 535 (delta 0), reused 0 (delta 0), pack-reused 535        
Receiving objects: 100% (535/535), 158.98 MiB | 16.17 MiB/s, done.
Resolving deltas: 100% (189/189), done.
Cloning into &#39;&lt;SOMEPATH&gt;/HarmonieCSC/src&#39;...
remote: Enumerating objects: 472517, done.        
remote: Counting objects: 100% (7780/7780), done.        
remote: Compressing objects: 100% (2433/2433), done.        
remote: Total 472517 (delta 5550), reused 6930 (delta 5329), pack-reused 464737        
Receiving objects: 100% (472517/472517), 560.70 MiB | 11.45 MiB/s, done.
Resolving deltas: 100% (381932/381932), done.
Cloning into &#39;&lt;SOMEPATH&gt;/HarmonieCSC/util/auxlibs&#39;...
remote: Enumerating objects: 2880, done.        
remote: Counting objects: 100% (2880/2880), done.        
remote: Compressing objects: 100% (1102/1102), done.        
remote: Total 2880 (delta 1614), reused 2880 (delta 1614), pack-reused 0        
Receiving objects: 100% (2880/2880), 20.29 MiB | 12.55 MiB/s, done.
Resolving deltas: 100% (1614/1614), done.
Cloning into &#39;&lt;SOMEPATH&gt;/HarmonieCSC/util/gl&#39;...
remote: Enumerating objects: 9414, done.        
remote: Counting objects: 100% (9414/9414), done.        
remote: Compressing objects: 100% (1839/1839), done.        
remote: Total 9414 (delta 5595), reused 9408 (delta 5593), pack-reused 0        
Receiving objects: 100% (9414/9414), 2.82 MiB | 4.56 MiB/s, done.
Resolving deltas: 100% (5595/5595), done.
Submodule path &#39;const&#39;: checked out &#39;6ff54331ba1e9253ffde7a0c5a003f6258f78fff&#39;
Submodule path &#39;src&#39;: checked out &#39;61847aa01cf880252d5bd35e57a417ed31d1cd08&#39;
Submodule path &#39;util/auxlibs&#39;: checked out &#39;626140284a8ec8eef5974cc7fb38b7d08105ea91&#39;
Submodule path &#39;util/gl&#39;: checked out &#39;9285e2fcdb76c5afb9444e227fb03a338b68ff6a&#39;</code></pre></li><li><p>all submodules in the user fork point to repositories in the Hirlam organisation, e.g.:</p><pre><code class="language-bash hljs">&gt; cd &lt;SOMEPATH&gt;/HarmonieCSC/src
&gt; git remote -v
origin	git@github.com:Hirlam/IAL.git (fetch)
origin	git@github.com:Hirlam/IAL.git (push)</code></pre></li><li><p>Add my fork of the IAL repository as remote, in the <code>src</code> directory, and fetch it:</p><pre><code class="language-bash hljs">&gt; cd &lt;SOMEPATH&gt;/HarmonieCSC/src
&gt; git remote add &lt;YOUR_GITHUB_USERNAME&gt; git@github.com:&lt;YOUR_GITHUB_USERNAME&gt;/IAL.git
&gt; git fetch &lt;YOUR_GITHUB_USERNAME&gt;
remote: Enumerating objects: 363, done.
remote: Counting objects: 100% (340/340), done.
remote: Compressing objects: 100% (77/77), done.
remote: Total 363 (delta 266), reused 328 (delta 263), pack-reused 23
Receiving objects: 100% (363/363), 315.12 KiB | 1.12 MiB/s, done.
Resolving deltas: 100% (268/268), completed with 56 local objects.
From github.com:&lt;YOUR_GITHUB_USERNAME&gt;/IAL
 * [new branch]            accord_CY49T0_bf                       -&gt; &lt;YOUR_GITHUB_USERNAME&gt;/accord_CY49T0_bf
 * [new branch]            accord_CY49T0_to_T1                    -&gt; &lt;YOUR_GITHUB_USERNAME&gt;/accord_CY49T0_to_T1
 * [new branch]            feature/markdown_docs                  -&gt; 
 *   &lt;YOUR_GITHUB_USERNAME&gt;/feature/markdown_docs
 * [new branch]            gco_CY46T1_bf                          -&gt; &lt;YOUR_GITHUB_USERNAME&gt;/gco_CY46T1_bf
 * [new branch]            gco_CY46T1_op1                         -&gt; &lt;YOUR_GITHUB_USERNAME&gt;/gco_CY46T1_op1
 * [new branch]            mary_CY48T1_preT2                      -&gt; &lt;YOUR_GITHUB_USERNAME&gt;/mary_CY48T1_preT2
 * [new branch]            master                                 -&gt; &lt;YOUR_GITHUB_USERNAME&gt;/master
 * [new tag]               CY49T0_T1rc.01                         -&gt; CY49T0_T1rc.01
 * [new tag]               CY49T0_bf.00                           -&gt; CY49T0_bf.00
 * [new tag]               CY49T0_bf.01                           -&gt; CY49T0_bf.01
 * [new tag]               CY49T0_bf.02                           -&gt; CY49T0_bf.02
 * [new tag]               CY49T0_op0.00                          -&gt; CY49T0_op0.00
 * [new tag]               CY49T0_to_T1.01                        -&gt; CY49T0_to_T1.01
 * [new tag]               CY49T0_to_T1.03                        -&gt; CY49T0_to_T1.03
 * [new tag]               CY49T0_to_T1.04                        -&gt; CY49T0_to_T1.04
 * [new tag]               CY49T0_to_T1.05                        -&gt; CY49T0_to_T1.05
 * [new tag]               CY49T0_to_T1.06                        -&gt; CY49T0_to_T1.06
 * [new tag]               CY49T0_to_T1.07                        -&gt; CY49T0_to_T1.07
 * [new tag]               CY49T0_to_T1.08                        -&gt; CY49T0_to_T1.08
 * [new tag]               CY49T0_to_T1.09                        -&gt; CY49T0_to_T1.09
 * [new tag]               CY49T1                                 -&gt; CY49T1
 * [new tag]               CY49T1_toT2.02                         -&gt; CY49T1_toT2.02</code></pre></li><li><p>Create a new branch in the <code>src</code> directory and check it out:</p><pre><code class="language-bash hljs">&gt; cd &lt;SOMEPATH&gt;/HarmonieCSC/src
&gt; git checkout -b &lt;YOUR_BRANCH&gt;
Switched to a new branch &#39;&lt;YOUR_BRANCH&gt;&#39;</code></pre></li><li><p>Make your changes to the submodule (and test everything carefully of course):</p></li><li><p><code>git status</code> will show modified files:</p><pre><code class="language-bash hljs">&gt; cd &lt;SOMEPATH&gt;/HarmonieCSC/src
&gt; git status
On branch &lt;YOUR_BRANCH&gt;
Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)
	modified:   surfex/SURFEX/interpol_npts.F90

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</code></pre></li><li><p>Stage and commit the changes, <em>e.g.</em>:</p><pre><code class="language-bash hljs">&gt; cd &lt;SOMEPATH&gt;/HarmonieCSC/src
git add surfex/SURFEX/interpol_npts.F90
git commit -m &#39;&lt;a good descriptive message&gt;&#39;</code></pre></li><li><p>Push the submodule to your fork of the submodule&#39;s repository:</p><pre><code class="language-bash hljs">&gt; cd &lt;SOMEPATH&gt;/HarmonieCSC/src
&gt; git push -u &lt;YOUR_GITHUB_USERNAME&gt; &lt;YOUR_BRANCH&gt;
Enumerating objects: 442, done.
Counting objects: 100% (374/374), done.
Delta compression using up to 256 threads
Compressing objects: 100% (123/123), done.
Writing objects: 100% (227/227), 84.20 KiB | 1.24 MiB/s, done.
Total 227 (delta 183), reused 144 (delta 103), pack-reused 0
remote: Resolving deltas: 100% (183/183), completed with 120 local objects.
remote: 
remote: Create a pull request for &#39;&lt;YOUR_BRANCH&gt;&#39; on GitHub by visiting:
remote:      https://github.com/&lt;YOUR_GITHUB_USERNAME&gt;/IAL/pull/new/&lt;&gt;
remote: 
To github.com:&lt;YOUR_GITHUB_USERNAME&gt;/IAL.git
 * [new branch]            &lt;YOUR_BRANCH&gt; -&gt; &lt;YOUR_BRANCH&gt;
Branch &#39;&lt;YOUR_BRANCH&gt;&#39; set up to track remote branch &#39;&lt;YOUR_BRANCH&gt;&#39; from 
&#39;&lt;YOUR_GITHUB_USERNAME&gt;&#39;.</code></pre></li><li><p>Go to github and create a pull request for the submodule. Make sure the correct base repository and branch are used in the PR!</p></li><li><p>After the PR for the submodule has been merged in, the hash of the submodule in the superproject needs to be updated</p></li><li><p>Get the latest changes of the submodule into your local copy and check out the newest commit:</p><pre><code class="language-bash hljs">&gt; cd &lt;SOMEPATH&gt;/HarmonieCSC/src
&gt; git fetch origin
remote: Enumerating objects: 1, done.
remote: Counting objects: 100% (1/1), done.
remote: Total 1 (delta 0), reused 1 (delta 0), pack-reused 0
Unpacking objects: 100% (1/1), 904 bytes | 14.00 KiB/s, done.
From github.com:Hirlam/IAL
   61847aa01c..f8d3d93767  dev-CY49T2h -&gt; origin/dev-CY49T2h
&gt; git checkout origin
Previous HEAD position was 61847aa01c Updates for CMake compilation of CY49T2h (Hirlam/IAL#7)
HEAD is now at f8d3d93767 Fix a FPE (NaN) in PGD, instead of ZDIST, use X, which is ZDIST passed to internal 
submodule ORDERI (#10)</code></pre></li></ul><p>Ensure that this is indeed the commit of the submodule you want to use in the superproject.</p><ul><li>Go to the superproject&#39;s directory and create and check out a new branch:<pre><code class="language-bash hljs">&gt; cd &lt;SOMEPATH&gt;/HarmonieCSC
&gt; git checkout -b &lt;YOUR_BRANCH&gt;
Switched to a new branch &#39;&lt;YOUR_BRANCH&gt;&#39;</code></pre></li><li>Update the submodule&#39;s hash, <code>src</code> in the example, and commit the change:<pre><code class="language-bash hljs">&gt; cd &lt;SOMEPATH&gt;/HarmonieCSC
&gt; git add src
&gt; git commit -m &#39;&lt;another good log message&gt;&#39;</code></pre></li><li>Push the new branch to your user fork (remote: <code>origin</code>) of the superproject:<pre><code class="language-bash hljs">&gt; git push -u origin &lt;YOUR_BRANCH&gt;
Enumerating objects: 3, done.
Counting objects: 100% (3/3), done.
Delta compression using up to 256 threads
Compressing objects: 100% (2/2), done.
Writing objects: 100% (2/2), 297 bytes | 148.00 KiB/s, done.
Total 2 (delta 1), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (1/1), completed with 1 local object.
remote: 
remote: Create a pull request for &#39;&lt;YOUR_BRANCH&gt;&#39; on GitHub by visiting:
remote:      https://github.com/&lt;YOUR_GITHUB_USERNAME&gt;/HarmonieCSC/pull/new/&lt;YOUR_BRANCH&gt;
remote: 
To github.com:&lt;YOUR_GITHUB_USERNAME&gt;/HarmonieCSC.git
 * [new branch]        &lt;YOUR_BRANCH&gt; -&gt; &lt;YOUR_BRANCH&gt;
Branch &#39;&lt;YOUR_BRANCH&gt;&#39; set up to track remote branch &#39;&lt;YOUR_BRANCH&gt;&#39; from &#39;origin&#39;.</code></pre></li><li>Finally create a pull request to update the submodule&#39;s hash, as suggested by git above. Once this PR has been approved and merged in, you&#39;re done!</li></ul><h3 id="Scenario-3:-Changes-in-superproject-and-a-submodule"><a class="docs-heading-anchor" href="#Scenario-3:-Changes-in-superproject-and-a-submodule">Scenario 3: Changes in superproject and a submodule</a><a id="Scenario-3:-Changes-in-superproject-and-a-submodule-1"></a><a class="docs-heading-anchor-permalink" href="#Scenario-3:-Changes-in-superproject-and-a-submodule" title="Permalink"></a></h3><p>If changes are needed in both the superproject (<em>e.g.</em> namelist) and submodules (<em>e.g.</em> new namelist variable) the steps are very similar to the scenario in which only a submodule needs to be modified. In the step where the submodule&#39;s hash is updated in the superproject, additional commits to the superproject&#39;s own files can be pushed and included in the same pull request.</p><hr/><h2 id="For-developers-2"><a class="docs-heading-anchor" href="#For-developers-2">For developers++</a><a class="docs-heading-anchor-permalink" href="#For-developers-2" title="Permalink"></a></h2><p>This section describes some git submodule actions that regular users probably never need to worry about.</p><h3 id="Merge-from-dev-CY46h1-into-dev-CY49T2h"><a class="docs-heading-anchor" href="#Merge-from-dev-CY46h1-into-dev-CY49T2h">Merge from dev-CY46h1 into dev-CY49T2h</a><a id="Merge-from-dev-CY46h1-into-dev-CY49T2h-1"></a><a class="docs-heading-anchor-permalink" href="#Merge-from-dev-CY46h1-into-dev-CY49T2h" title="Permalink"></a></h3><p><strong>ToDo</strong></p><h3 id="Adding-a-submodule"><a class="docs-heading-anchor" href="#Adding-a-submodule">Adding a submodule</a><a id="Adding-a-submodule-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-a-submodule" title="Permalink"></a></h3><p>To add a new submodule to the superproject, got to the cloned superproject&#39;s directory, create a new branch and then add the submodule:</p><pre><code class="language-bash hljs">git submodule add &lt;submodule_url&gt; [&lt;new_submodule_path&gt;]</code></pre><p>The path to the submodule and updated <code>.gitmodules</code> file will be staged automatically, e.g.:</p><pre><code class="language-bash hljs">&gt; git status
On branch main
Your branch is up to date with &#39;origin/main&#39;.

Changes to be committed:
  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)
        new file:   .gitmodules
        new file:   &lt;new_submodule_path&gt;</code></pre><p>Then simply commit (<code>git commit</code>) and push (<code>git push</code>).</p><hr/><h2 id="More-info"><a class="docs-heading-anchor" href="#More-info">More info</a><a id="More-info-1"></a><a class="docs-heading-anchor-permalink" href="#More-info" title="Permalink"></a></h2><ul><li>https://git-scm.com/book/en/Git-Tools-Submodules</li><li>https://www.atlassian.com/git/tutorials/git-submodule</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../GitDeveloperDocumentation/">« GitHub workflow</a><a class="docs-footer-nextpage" href="../../Overview/da_graph/">Graphical Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 16 October 2024 09:19">Wednesday 16 October 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
