<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GL · Harmonie wiki</title><meta name="title" content="GL · Harmonie wiki"/><meta property="og:title" content="GL · Harmonie wiki"/><meta property="twitter:title" content="GL · Harmonie wiki"/><meta name="description" content="Documentation for Harmonie wiki."/><meta property="og:description" content="Documentation for Harmonie wiki."/><meta property="twitter:description" content="Documentation for Harmonie wiki."/><meta property="og:url" content="https://hirlam.github.io/HarmonieSystemDocumentation/dev/PostProcessing/gl/"/><meta property="twitter:url" content="https://hirlam.github.io/HarmonieSystemDocumentation/dev/PostProcessing/gl/"/><link rel="canonical" href="https://hirlam.github.io/HarmonieSystemDocumentation/dev/PostProcessing/gl/"/><script async src="https://www.googletagmanager.com/gtag/js?id=G-HQ1BCP3LPJ"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HQ1BCP3LPJ', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Harmonie wiki logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Harmonie wiki</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../System/GitDeveloperDocumentation/">GitHub workflow</a></li><li><a class="tocitem" href="../../Overview/da_graph/">Graphical Overview</a></li><li><a class="tocitem" href="../../System/ECMWF/RunningHarmonieOnAtos/">Running on Atos</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Overview</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Overview/Content/">Content</a></li><li><a class="tocitem" href="../../Overview/Binaries/">Binaries</a></li><li><a class="tocitem" href="../../Overview/FileFormats/">File Formats</a></li><li><a class="tocitem" href="../../Overview/Source/">Source</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Experiment Configuration</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ExperimentConfiguration/ConfigureYourExperiment/">Experiment</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/Namelists/">Namelist</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/UseofObservation/">Observations</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/PlatformConfiguration/">Platform</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/How_to_use_hires_topography/">HiRes Topography</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/ModelDomain/">Domain</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/VerticalGrid/">Vertical Grid</a></li></ul></li></ul></li><li><span class="tocitem">NWP Components</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Observations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1-1"><span class="docs-label">Preprocessing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Observations/ObservationPreprocessing/">Preprocessing</a></li><li><a class="tocitem" href="../../Observations/Oulan/">Oulan</a></li><li><a class="tocitem" href="../../Observations/Bator/">Bator</a></li><li><a class="tocitem" href="../../Observations/Cope/">Cope</a></li><li><a class="tocitem" href="../../Observations/ObservationData/">ObservationData</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Observations/SYNOP/">SYNOP</a></li><li><a class="tocitem" href="../../Observations/Amv/">AMV</a></li><li><a class="tocitem" href="../../Observations/Atovs/">ATOVS</a></li><li><a class="tocitem" href="../../Observations/Iasi/">IASI</a></li><li><a class="tocitem" href="../../Observations/Seviri/">SEVIRI</a></li><li><a class="tocitem" href="../../Observations/Scatt/">Scatt</a></li><li><a class="tocitem" href="../../Observations/Ascat/">AScat</a></li><li><a class="tocitem" href="../../Observations/GNSS/">GNSS</a></li><li><a class="tocitem" href="../../Observations/Modes/">Modes</a></li><li><a class="tocitem" href="../../Observations/RadarData/">Radar</a></li><li><a class="tocitem" href="../../Observations/Aeolus/">Aeolus</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Data Assimilation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-2-1" type="checkbox"/><label class="tocitem" for="menuitem-3-2-1"><span class="docs-label">Surface</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI/">CANARI</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI_OI_MAIN/">CANARI OI MAIN</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI_EKF_SURFEX/">CANARI EKF SURFEX</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/SurfaceAnalysis/">Surface Analysis</a></li></ul></li><li><a class="tocitem" href="../../DataAssimilation/Screening/">Screening</a></li><li><a class="tocitem" href="../../DataAssimilation/StructureFunctions/">Structure functions</a></li><li><a class="tocitem" href="../../DataAssimilation/DaAlgorithms/">Algorithms</a></li><li><a class="tocitem" href="../../DataAssimilation/DigitalFilterInitialization/">Digital Filter Initialization</a></li><li><a class="tocitem" href="../../DataAssimilation/ObservationOperators/">HOP_DRIVER</a></li><li><a class="tocitem" href="../../DataAssimilation/SingleObs/">Single Obs</a></li><li><a class="tocitem" href="../../DataAssimilation/LSMIXandJk/">LSMIX and Jk</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-3-1"><span class="docs-label">Data Assimilation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/DFS/">DFS</a></li><li><a class="tocitem" href="../../DataAssimilation/MTEN/">MTEN</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-3-2"><span class="docs-label">Forecast(spin-up)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/CHKEVO/">CHKEVO</a></li><li><a class="tocitem" href="../../DataAssimilation/NWECHKEVO/">NWECHKEVO</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Boundaries</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Boundaries/BoundaryFilePreparation/">Preparation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Forecast Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ForecastModel/Forecast/">Forecast</a></li><li><a class="tocitem" href="../../ForecastModel/ForecastSettings/">Settings</a></li><li><a class="tocitem" href="../../ForecastModel/Outputlist/">Output List</a></li><li><a class="tocitem" href="../../ForecastModel/HR/">High Res</a></li><li><input class="collapse-toggle" id="menuitem-3-5-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5-5"><span class="docs-label">Single Column Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC/">MUSC</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/Forcing/">Forcing</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC_EMS/">MUSC EMS</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC_vars/">MUSC vars</a></li></ul></li><li><a class="tocitem" href="../../ForecastModel/WindFarms/">Wind Farm Parameterisation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Climate Generation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ClimateGeneration/ClimateGeneration/">Climate Generation</a></li><li><a class="tocitem" href="../../ClimateGeneration/DownloadInputData/">Input Data</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">EPS</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../EPS/Howto/">Howto</a></li><li><a class="tocitem" href="../../EPS/System/">System</a></li><li><a class="tocitem" href="../../EPS/BDSTRATEGY/">BDSTRATEGY</a></li><li><a class="tocitem" href="../../EPS/SLAF/">SLAF</a></li><li><a class="tocitem" href="../../EPS/SPP/">SPP</a></li><li><a class="tocitem" href="../../EPS/SPPT/">SPPT</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-8" type="checkbox" checked/><label class="tocitem" for="menuitem-3-8"><span class="docs-label">Post Processing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../FileConversions/">FileConversions</a></li><li><a class="tocitem" href="../Fullpos/">FullPos</a></li><li class="is-active"><a class="tocitem" href>GL</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#ecCodes-definition-tables"><span>ecCodes definition tables</span></a></li><li><a class="tocitem" href="#GRIB/FA/LFI-file-listing"><span>GRIB/FA/LFI file listing</span></a></li><li><a class="tocitem" href="#GRIB/FA/LFI-file-conversion"><span>GRIB/FA/LFI file conversion</span></a></li><li><a class="tocitem" href="#postprocessing"><span>postprocessing</span></a></li><li><a class="tocitem" href="#Vertical-interpolation"><span>Vertical interpolation</span></a></li><li><a class="tocitem" href="#Horizontal-interpolation"><span>Horizontal interpolation</span></a></li><li><a class="tocitem" href="#Extract-(crop)-a-sub-domain"><span>Extract (crop) a sub-domain</span></a></li><li><a class="tocitem" href="#Rotating-wind-components"><span>Rotating wind components</span></a></li><li><a class="tocitem" href="#Output-to-several-files"><span>Output to several files</span></a></li><li><a class="tocitem" href="#Input-from-several-files"><span>Input from several files</span></a></li><li><a class="tocitem" href="#domain_prop"><span><code>domain_prop</code></span></a></li><li><a class="tocitem" href="#fldextr-and-obsextr"><span>fldextr and obsextr</span></a></li></ul></li><li><a class="tocitem" href="../xtool/">xtool</a></li><li><a class="tocitem" href="../Interpolation/">Interpolation GL</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-9" type="checkbox"/><label class="tocitem" for="menuitem-3-9"><span class="docs-label">Verification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Verification/Extract4verification/">Extract4verification</a></li><li><a class="tocitem" href="../../Verification/Verification/">Verification</a></li><li><a class="tocitem" href="../../Verification/AllobsVerification/">allobs Verification</a></li><li><a class="tocitem" href="../../Verification/HARP/">HARP</a></li><li><a class="tocitem" href="../../Verification/Obsmon/">Obsmon</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-10" type="checkbox"/><label class="tocitem" for="menuitem-3-10"><span class="docs-label">Visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Visualization/EPyGrAM/">EpyGram</a></li></ul></li></ul></li><li><span class="tocitem">System</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Build</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Build/Build_with_cmake/">CMake</a></li><li><a class="tocitem" href="../../Build/Build_with_makeup/">Makeup</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Phasing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../System/MFaccess/">MF Access</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Suite Management</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../SuiteManagement/ECFLOW/">ECFLOW</a></li></ul></li><li><a class="tocitem" href="../../System/TheHarmonieScript/">The Harmonie script</a></li><li><a class="tocitem" href="../../System/ECMWF/RunningHarmonieOnAtos/">Running on ECMWF&#39;s Atos</a></li><li><a class="tocitem" href="../../System/ReleaseProcess/">Harmonie release process</a></li><li><a class="tocitem" href="../../System/Local/QuickStartLocal/">Local</a></li><li><a class="tocitem" href="../../System/HarmonieTestbed/">Testbed</a></li><li><a class="tocitem" href="../../System/ECMWF/ECMWF_teleport/">Teleport</a></li><li><a class="tocitem" href="../../System/Build_local_docs/">Local Documentation</a></li><li><a class="tocitem" href="../../System/DrHook/">DrHook</a></li><li><a class="tocitem" href="../../System/StandaloneOdb/">Stand alone ODB</a></li><li><a class="tocitem" href="../../System/UpdateNamelists/">Update Namelist</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">NWP Components</a></li><li><a class="is-disabled">Post Processing</a></li><li class="is-active"><a href>GL</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>GL</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Hirlam/Harmonie" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Hirlam/Harmonie/blob/dev-CY46h1/docs/src/PostProcessing/gl.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="gl"><a class="docs-heading-anchor" href="#gl">Post processing with gl</a><a id="gl-1"></a><a class="docs-heading-anchor-permalink" href="#gl" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>gl ( as in <strong>g</strong>rib<strong>l</strong>ist ) is a multi purpose tool for file manipulation and conversion. It uses ECMWF&#39;s   <a href="https://confluence.ecmwf.int//display/ECC/What+is+ecCodes">ecCodes</a> library, and can be compiled with and without support for HARMONIE FA/LFI or NETCDF files. The gl package also includes software for extraction for verification, fldextr, and field comparison, <a href="../xtool/#xtool">xtool</a>.</p><pre><code class="language-bash hljs"> USAGE: gl file [-n namelist_file] [-o output_file] -[lfgmicp(nc)sdtq] [-lbc CONF]

 gl [-f] file, list the content of a file, -f for FA/lfi files  
 -c    : Convert a FA/lfi file to grib ( -f implicit )          
 -p    : Convert a FA file to grib output without extension zone
         (-c and -f implicit )                                  
 -nc   : Convert a FA/lfi file to NetCDF ( -f implicit )        
 -musc : Convert a MUSC FA file ASCII ( -c implicit )           
 -lbc ARG : Convert a CONF file to HARMONIE input               
            where CONF is ifs or hir as in ECMWF/HIRLAM data    
         climate_aladin assumed available                       
 -d    : Together with -lbc it gives a (bogus) NH boundary file   
         climate_aladin assumed available                       
 -s    : Work as silent as possible                             
 -g    : Prints ksec/cadre/lfi info                             
 -m    : Prints min,mean,max of the fields                      
 -i    : Prints the namelist options (useless)                  
 -tp   : Prints the GRIB parameter usage                        
 -t    : Prints the FA/lfi/GRIB table (useful)                  
 -wa   : Prints the atmosphere FA/NETCDF/GRIB table in wiki fmt 
 -ws   : Prints the surfex FA/NETCDF/GRIB table in wiki fmt     
 -q    : Cross check the FA/lfi/GRIB table (try)                
 -pl X : Give polster_projlat in degrees                        

 gl file -n namelist_file : interpolates file according to      
                            namelist_file                       
 gl -n namelist_file : creates an empty domain according to     
                       specifications in namelist_file          
 -igd  : Set lignore_duplicates=T                               
 -igs  : Set lignore_shortname=T. Use indicatorOfParameter      
             instead of shortName for selection                 
</code></pre><h2 id="ecCodes-definition-tables"><a class="docs-heading-anchor" href="#ecCodes-definition-tables">ecCodes definition tables</a><a id="ecCodes-definition-tables-1"></a><a class="docs-heading-anchor-permalink" href="#ecCodes-definition-tables" title="Permalink"></a></h2><p>Since ecCodes has replaced <code>grib_api</code> as the ECMWF primary software package to handle GRIB, we will hereafter only refer to ecCodes but same similar settings applies for <code>grib_api</code> as well. With the change to ecCodes we heavily rely on the shortName key for identification. To get the correct connection between the shortnames and the GRIB1/GRIB2 identifiers we have defined specific tables for harmonie. These tables can be found in <code>/util/gl/definitions</code>. To use these tables you have to define the <code>ECCODES_DEFINITION_PATH</code> environment variable as </p><pre><code class="language-bash hljs">export ECCODES_DEFINITION_PATH=SOME_PATH/gl/definitions:PATH_TO_YOUR_ECCODES_INSTALLATION</code></pre><p>If this is not set correctly the interpretation of the fields may be wrong.</p><h2 id="GRIB/FA/LFI-file-listing"><a class="docs-heading-anchor" href="#GRIB/FA/LFI-file-listing">GRIB/FA/LFI file listing</a><a id="GRIB/FA/LFI-file-listing-1"></a><a class="docs-heading-anchor-permalink" href="#GRIB/FA/LFI-file-listing" title="Permalink"></a></h2><p>Listing of GRIB/ASIMOF/FA/LFI files.</p><pre><code class="language-bash hljs"> gl [-l] [-f] [-m] [-g] FILE</code></pre><p>where FILE is in GRIB/ASIMOF/FA/LFI format</p><table><tr><th style="text-align: left">Option</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>-l</code></td><td style="text-align: left">input format is LFI</td></tr><tr><td style="text-align: left"><code>-f</code></td><td style="text-align: left">input format is FA</td></tr><tr><td style="text-align: left"></td><td style="text-align: left"><code>-l</code> and <code>-f</code> are equivalent</td></tr><tr><td style="text-align: left"><code>-g</code></td><td style="text-align: left">print GRIB/FA/LFI header</td></tr><tr><td style="text-align: left"><code>-m</code></td><td style="text-align: left">print min/mean/max values</td></tr></table><h2 id="GRIB/FA/LFI-file-conversion"><a class="docs-heading-anchor" href="#GRIB/FA/LFI-file-conversion">GRIB/FA/LFI file conversion</a><a id="GRIB/FA/LFI-file-conversion-1"></a><a class="docs-heading-anchor-permalink" href="#GRIB/FA/LFI-file-conversion" title="Permalink"></a></h2><h3 id="Output-to-GRIB1"><a class="docs-heading-anchor" href="#Output-to-GRIB1">Output to GRIB1</a><a id="Output-to-GRIB1-1"></a><a class="docs-heading-anchor-permalink" href="#Output-to-GRIB1" title="Permalink"></a></h3><pre><code class="language-bash hljs">gl [-c] [-p] FILE [ -o OUTPUT_FILE] [ -n NAMELIST_FILE]</code></pre><p>where </p><table><tr><th style="text-align: right"></th><th style="text-align: right"></th></tr><tr><td style="text-align: right">-c</td><td style="text-align: right">converts the full field (including extension zone) from FA to GRIB1</td></tr><tr><td style="text-align: right">-p</td><td style="text-align: right">converts field excluding the extension zone (&quot;p&quot; as in physical domain) from FA to GRIB1</td></tr></table><p>The FA/LFI to GRIB mapping is done in a table defined by a <code>util/gl/inc/trans_tab.h</code></p><p>To view the table:</p><pre><code class="language-bash hljs">gl -t
gl -tp</code></pre><p>To check for duplicates in the table:</p><pre><code class="language-bash hljs">gl -q</code></pre><p>The translation from FA/LFI to GRIB1 can be changed through a namelist like this one:</p><pre><code class="language-bash hljs">  &amp;naminterp
    user_trans%full_name =&#39;CLSTEMPERATURE&#39;,
    user_trans%t2v       = 253,
    user_trans%pid       = 123,
    user_trans%levtype   = &#39;heigthAboveGround&#39;,
    user_trans%level     = 002,
    user_trans%tri       = 000,
  /</code></pre><p>or for the case where the level number is included in the FA name</p><pre><code class="language-bash hljs">  &amp;naminterp
    user_trans%full_name=&#39;SNNNEZDIAG01&#39;,
    user_trans%cpar=&#39;S&#39;
    user_trans%ctyp=&#39;EZDIAG01&#39;,
    ...
  /</code></pre><p>Conversion can be refined to convert a selection of fields. Below is and example that will write out </p><ul><li>T (shortname=&#39;t&#39;,pid=011), u (shortname=&#39;u&#39;,pid=033) andv (shortname=&#39;v&#39;,pid=034) on all (level=-1) model levels (levtype=&#39;hybrid&#39;)</li><li>T (shortname=&#39;t&#39;,pid=011) at 2m (lll=2) above the ground (levtype=&#39;heightAboveGround&#39;) [T2m]</li><li>Total precipitation (shortname=&#39;tp&#39;,pid=061,levtype=&#39;heightAboveGround&#39;,level=000)</li></ul><pre><code class="language-bash hljs">  &amp;naminterp
   readkey%shortname=   &#39;t&#39;,     &#39;u&#39;,     &#39;v&#39;,                &#39;t&#39;,               &#39;tp&#39;,               &#39;fg&#39;,
   readkey%levtype=&#39;hybrid&#39;,&#39;hybrid&#39;,&#39;hybrid&#39;,&#39;heightAboveGround&#39;,&#39;heightAboveGround&#39;,&#39;heightAboveGround&#39;,
   readkey%level=        -1,      -1,      -1,                  2,                  0,                 10,
   readkey%tri =          0,       0,       0,                  0,                  4,                  2,
  /</code></pre><p>where </p><ul><li>shortname is the ecCodes shortname of the parameter </li><li>levtype is the ecCodes level type</li><li>level is the GRIB level</li><li>tri means timeRangeIndicator and is set to distinguish between instantaneous, accumulated and min/max values.</li></ul><p>The first three ones are well known to most users. The time range indicator is used in HARMONIE to distinguish between instantaneous and accumulated fields. Read more about the options <a href="../../ForecastModel/Outputlist/#outputlist">here</a> Note that for levtype hybrid setting level=-1 means all. </p><p>We can also pick variables using their FA/lfi name:</p><pre><code class="language-bash hljs">  &amp;naminterp
    readkey%faname = &#39;SPECSURFGEOP&#39;,&#39;SNNNTEMPERATURE&#39;,
  /</code></pre><p>Where <code>SNNNTEMPERATURE</code> means that we picks all levels.</p><p>Fields can be excluded from the conversion by name</p><pre><code class="language-bash hljs">  &amp;naminterp
    exclkey%faname = &#39;SNNNTEMPERATURE&#39;
  /</code></pre><h3 id="Output-to-GRIB2"><a class="docs-heading-anchor" href="#Output-to-GRIB2">Output to GRIB2</a><a id="Output-to-GRIB2-1"></a><a class="docs-heading-anchor-permalink" href="#Output-to-GRIB2" title="Permalink"></a></h3><p>To get GRIB2 files the format has to be set in the namelist as </p><pre><code class="language-bash hljs">  &amp;naminterp
    output_format = &#39;GRIB2&#39;
  /</code></pre><p>The conversion from FA to GRIB2 is done in gl via the ecCodes tables. All translations are defined in <code>util/gl/scr/harmonie_grib1_2_grib2.pm</code> where we find all settings required to specify a parameter in GRIB1 and GRIB2.</p><pre><code class="language-bash hljs">
  tmax =&gt; {
   editionNumber=&gt; &#39;2&#39;,
   comment=&gt; &#39;Maximum temperature&#39;,
   discipline=&gt; &#39;0&#39;,
   indicatorOfParameter=&gt; &#39;15&#39;,
   paramId=&gt; &#39;253015&#39;,
   parameterCategory=&gt; &#39;0&#39;,
   parameterNumber=&gt; &#39;0&#39;,
   shortName=&gt; &#39;tmax&#39;,
   table2Version=&gt; &#39;253&#39;,
   typeOfStatisticalProcessing=&gt; &#39;2&#39;,
   units=&gt; &#39;K&#39;,
  },
</code></pre><p>To create ecCodes tables from this file run</p><pre><code class="language-bash hljs">   cd gl/scr
   ./gen_tables.pl harmonie_grib1_2_grib2</code></pre><p>and copy the grib1/grib2 directories to gl/definitions.</p><p>Note that there are no GRIB2 transations yet defined for the SURFEX fields!</p><h3 id="Output-to-NetCDF"><a class="docs-heading-anchor" href="#Output-to-NetCDF">Output to NetCDF</a><a id="Output-to-NetCDF-1"></a><a class="docs-heading-anchor-permalink" href="#Output-to-NetCDF" title="Permalink"></a></h3><pre><code class="language-bash hljs">gl -nc [-p] FILE [ -o OUTPUT_FILE] [ -n NAMELIST_FILE]</code></pre><p>where </p><table><tr><th style="text-align: right"></th><th style="text-align: right"></th></tr><tr><td style="text-align: right">-p</td><td style="text-align: right">converts field excluding the extension zone (&quot;p&quot; as in physical domain) from FA to NetCDF</td></tr><tr><td style="text-align: right">-o</td><td style="text-align: right">output file name</td></tr><tr><td style="text-align: right">-n</td><td style="text-align: right">namelist file to be used in conversion</td></tr></table><p>The FA/LFI to NetCDF mapping is done using tables defined by <code>util/gl/inc/trans_tab.h</code> and <code>util/gl/inc/nc_tab.h</code></p><h4 id="Namelist-options-for-NetCDF"><a class="docs-heading-anchor" href="#Namelist-options-for-NetCDF">Namelist options for NetCDF</a><a id="Namelist-options-for-NetCDF-1"></a><a class="docs-heading-anchor-permalink" href="#Namelist-options-for-NetCDF" title="Permalink"></a></h4><p>The translation from FA/LFI to NetCDF can be changed through a namelist like this one:</p><pre><code class="language-bash hljs">  &amp;naminterp
    user_nctrans%full_name =&#39;SFX.SIC&#39;,
    user_nctrans%s_name    = &quot;&quot;       
    user_nctrans%l_name    = &quot;Sea-Ice Area Percentage (Atmospheric Grid)&quot;,
    user_nctrans%unit      = &quot;%&quot;                 ,
  /</code></pre><p>The <code>unit</code> entry can be used to do a limited set of unit conversions, in the example above SIC will be converted from the original units (fraction) to a percentage.</p><p>Other specific naminterp options for converting to netcdf:</p><table><tr><th style="text-align: right">variable</th><th style="text-align: right">description</th><th style="text-align: right">default</th></tr><tr><td style="text-align: right">lacc2flux</td><td style="text-align: right">T: Convert accumulated fields (tri=4) to fluxes by dividing by the length of the interval FF-F0. Names, units and tri are adapted.</td><td style="text-align: right">.FALSE.</td></tr><tr><td style="text-align: right">lmergelevs</td><td style="text-align: right">T: write all levels of a variable to the same file; F: each level in a separate file</td><td style="text-align: right">.FALSE.</td></tr><tr><td style="text-align: right">lclimate_fields</td><td style="text-align: right">T: don&#39;t add a time dimension and variable, useful for climate fields like land mask</td><td style="text-align: right">.FALSE.</td></tr><tr><td style="text-align: right">lvertices</td><td style="text-align: right">T: add vertices (corner points) to netcdf file, only possible for newly created files</td><td style="text-align: right">.FALSE.</td></tr><tr><td style="text-align: right">lhistory</td><td style="text-align: right">T: add history global attribute to netcdf file</td><td style="text-align: right">.FALSE.</td></tr><tr><td style="text-align: right">ikindnc</td><td style="text-align: right">NetCDF version (3</td><td style="text-align: right">4), 3: larger files, but faster; 4: compressed, but slow</td></tr><tr><td style="text-align: right">ref_date</td><td style="text-align: right">Reference date, used to generate relative time axis</td><td style="text-align: right">19500101</td></tr><tr><td style="text-align: right">ref_hour</td><td style="text-align: right">Reference hour, used to generate relative time axis</td><td style="text-align: right">0</td></tr><tr><td style="text-align: right">ctimeis</td><td style="text-align: right">time refers to &quot;start&quot;, &quot;middle&quot;, or &quot;end&quot; of interval for non-instantaneous fields. If writing several variables to 1 file, that don&#39;t have the same timing (e.g. accumulated vs. instantaneous), then &quot;end&quot; is probably the only safe option!</td><td style="text-align: right">end</td></tr><tr><td style="text-align: right">csep</td><td style="text-align: right">separator in derived netcdf file name</td><td style="text-align: right">_</td></tr><tr><td style="text-align: right">cdatefname</td><td style="text-align: right">format for date in derived netcdf file name, if not recognized as format, use whatever is passed</td><td style="text-align: right">YYYYMMDDHH</td></tr><tr><td style="text-align: right">cfiden</td><td style="text-align: right">used in derived netcdf file name to indicate origin (e.g. his, sfx, fp)</td><td style="text-align: right"></td></tr><tr><td style="text-align: right">cfreq</td><td style="text-align: right">used in derived netcdf file name and as &quot;frequency&quot; global attribute (e.g. 1hr, 3hr, day, mon)</td><td style="text-align: right"></td></tr><tr><td style="text-align: right">chm_rev</td><td style="text-align: right">HARMONIE version, used as &quot;model_id&quot; global attribute</td><td style="text-align: right"></td></tr><tr><td style="text-align: right">cdomain</td><td style="text-align: right">domain name, used in derived netcdf file name and as &quot;domain&quot; global attribute</td><td style="text-align: right"></td></tr><tr><td style="text-align: right">cexperiment</td><td style="text-align: right">experiment id, used in derived netcdf file name and as &quot;experiment_id&quot; global attribute</td><td style="text-align: right"></td></tr><tr><td style="text-align: right">cinstitute</td><td style="text-align: right">used as &quot;institute_id&quot; global attribute</td><td style="text-align: right"></td></tr><tr><td style="text-align: right">chostmod</td><td style="text-align: right">used as &quot;driving<em>model</em>id&quot; global attribute</td><td style="text-align: right"></td></tr></table><h5 id="Setting-fstart-for-min-max-fields"><a class="docs-heading-anchor" href="#Setting-fstart-for-min-max-fields">Setting fstart for min-max fields</a><a id="Setting-fstart-for-min-max-fields-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-fstart-for-min-max-fields" title="Permalink"></a></h5><p>Min and max fields, with <code>tri=2</code> (time range indicator) are valid for a certain period. By default the period is 3h, but this can be changed via variables <code>FREQ_RESET_TEMP</code> and <code>FREQ_RESET_GUST</code> in <code>ecf/config_exp.h</code>, for example to 1 to store min/max temperature over an hour. By default gl doesn’t have info on this frequency and it is assumed they are valid since the start of the run. Use the namelist option <code>fstart</code> to assign the appropriate starting value, e.g.:</p><pre><code class="nohighlight hljs">fstart(15) = 3</code></pre><p>for max t2m (parameter code 15). The <code>fstart</code> value is then used in the <code>time_bnds</code>. This value needs to be updated with <code>FREQ_RESET</code>. In Makegrib_gribex and convertFA there are examples of how to do this. Note that this works in the same way for NetCDF and GRIB.</p><h4 id="Derived-file-name"><a class="docs-heading-anchor" href="#Derived-file-name">Derived file name</a><a id="Derived-file-name-1"></a><a class="docs-heading-anchor-permalink" href="#Derived-file-name" title="Permalink"></a></h4><p>If no output file name is supplied (-o flag) an output file name is derived from available info:</p><pre><code class="nohighlight hljs">nc_fld_name[_levinfo][_cfiden][_cdomain][_cexperiment][_cfreq][_timeinfo].nc</code></pre><p>with: |             |                                                                                                                                 | | –-         | –-                                                                                                                             | | nc<em>fld</em>name | name of netcdf variable as defined in nc<em>tab.h                                                                                  | | levinfo     | indication of level info, with *lev if all levels are written to the same file (lsplitlev), or a level number/height otherwise  | | cfiden      | identifier of input file (e.g. his, sfx), set via namelist                                                                      | | cdomain     | domain name, set via namelist                                                                                                   | | cexperiment | experiment name, set via namelist                                                                                               | | cfreq       | frequency, set via namelist                                                                                                     | | timeinfo    | indicator of file date/time, format controlled via cdatefname namelist variable, not used if lclimate</em>fields                    |</p><p>If elements are not set, either via the namelist or by a default value, they are excluded from the name. The separator is a _ by default but can be changed via the csep namelist variable. </p><h4 id="Time-axis"><a class="docs-heading-anchor" href="#Time-axis">Time axis</a><a id="Time-axis-1"></a><a class="docs-heading-anchor-permalink" href="#Time-axis" title="Permalink"></a></h4><p>A relative time axis (days since …) is created using the refdate and refhour as reference. In existing files the current time step is looked up, and if it already exists it is overwritten. If it doesn’t exist yet, it is appended to the end of the file. Note that if time steps are not converted in order the time axis will not be consecutive. For non-instantaneous fields a time bounds variable is added. The start of the interval is taken from fstart (from tri=2) or outkey%F0, or just from the input file (usually 0). The end of the interval is the current time step. Whether the time variables refers to the beginning, middle or end of the interval can be controlled with the ctimeis namelist variable. If instantaneous and non-instantaneous files are written to the same file, it is best to use ctimeis=end. Start may also work, but this should be tested first. With the namelist variable cdatefname you can write output from multiple cycles to the same file. For example by setting it to <code>YYYYMM</code> the derived file name will contain year and month info, but not day and hour, so all cycles from a month are written to the same file. Be careful with the first time step of a cycle when using cdatefname as gl will overwrite the last time step of the previous cycle with those of the first step of the new cycle. You can decide to skip the first time step, or multiple steps, if cycles overlap more than 1 step. </p><h4 id="Multilevel-fields-and-fields-on-heights-or-pressure-levels"><a class="docs-heading-anchor" href="#Multilevel-fields-and-fields-on-heights-or-pressure-levels">Multilevel fields and fields on heights or pressure levels</a><a id="Multilevel-fields-and-fields-on-heights-or-pressure-levels-1"></a><a class="docs-heading-anchor-permalink" href="#Multilevel-fields-and-fields-on-heights-or-pressure-levels" title="Permalink"></a></h4><p>All levels of multilevel fields can be written to one file (<code>lmergelevs=.TRUE.</code>) or to separate files (default). This is possible for model levels, pressure levels and height levels.</p><h5 id="All-levels-in-one-file"><a class="docs-heading-anchor" href="#All-levels-in-one-file">All levels in one file</a><a id="All-levels-in-one-file-1"></a><a class="docs-heading-anchor-permalink" href="#All-levels-in-one-file" title="Permalink"></a></h5><p>If all levels are written to the same file and additional dimension is needed: lev for model levels, height for height levels. For model level fields, named SNNN<em>, the number of levels is derived from the input file (glistnlev). For height level fields, HNNNNN</em>, currently the heights must be set via the hlevlist namelist variable. The heights in this list are used to expand the HNNNNN (to H00010, H00250 etc) and are also used as coordinate variable. For pressure levels PNNNNN is used in the same way.</p><h5 id="Single-level-fields-on-height"><a class="docs-heading-anchor" href="#Single-level-fields-on-height">Single level fields on height</a><a id="Single-level-fields-on-height-1"></a><a class="docs-heading-anchor-permalink" href="#Single-level-fields-on-height" title="Permalink"></a></h5><p>For single level fields on a specific height such as 2m temperature and 10m wind a height variable is added with that height. This is done if level type = 105 and level ≠ 0. This may not be appropriate in all cases. Note that for some fields level is abused (e.g. level 760 for the sea tile), which gives useless height. The same approach is used when outputting multilevel fields with lsplitlev=.TRUE. (default).</p><h5 id="Don’t-mix-fields"><a class="docs-heading-anchor" href="#Don’t-mix-fields">Don’t mix fields</a><a id="Don’t-mix-fields-1"></a><a class="docs-heading-anchor-permalink" href="#Don’t-mix-fields" title="Permalink"></a></h5><p>There is a check that all fields on height levels in one file have the same height specification, because only 1 height variable can be specified at the moment. So t2m and w10m cannot be in the same file. Not sure if the check is foolproof. It may be possible to define multiple heights in the code, e.g. height, height2 etc., but this has not been implemented yet. </p><h4 id="NetCDF-3-or-NetCDF-4"><a class="docs-heading-anchor" href="#NetCDF-3-or-NetCDF-4">NetCDF 3 or NetCDF 4</a><a id="NetCDF-3-or-NetCDF-4-1"></a><a class="docs-heading-anchor-permalink" href="#NetCDF-3-or-NetCDF-4" title="Permalink"></a></h4><p>With the ikindnc namelist options the netcdf format can be set. NetCDF 4 files are compressed in gl, however, this makes the conversion much slower. At the moment it seems better to let gl use the NetCDF 3 format and then convert them to NetCDF 4 after creation of the file has finished. This can be done with the following command:</p><pre><code class="language-bash hljs">nccopy -k 4 -d 1 -s $nc3_file $nc4_file</code></pre><p>where:</p><table><tr><th style="text-align: right"></th><th style="text-align: right"></th></tr><tr><td style="text-align: right">-d</td><td style="text-align: right">deflate level</td></tr><tr><td style="text-align: right">-s</td><td style="text-align: right">shuffling (can improve compression, speed and size)</td></tr></table><p>In <code>scr/convertFA</code> this can be done by setting <code>nc3to4=yes</code> (default). At the end of the script the files are then converted from netcdf3 to netcdf4-classic with compression.</p><h4 id="Direction-of-fluxes"><a class="docs-heading-anchor" href="#Direction-of-fluxes">Direction of fluxes</a><a id="Direction-of-fluxes-1"></a><a class="docs-heading-anchor-permalink" href="#Direction-of-fluxes" title="Permalink"></a></h4><p>A new element <code>positive</code> was added to the nctrans derived type in module<em>typez, and in nc</em>tab.h positive, can be empty, &#39;d&#39; or &#39;u&#39;. If it is not empty a <code>positive</code> attribute is added to the variable in the NetCDF file. If it has value &#39;u&#39;, the values of the variable are multiplied by −1 to change the direction from towards the surface to away from the surface.</p><h4 id="Fill-value"><a class="docs-heading-anchor" href="#Fill-value">Fill value</a><a id="Fill-value-1"></a><a class="docs-heading-anchor-permalink" href="#Fill-value" title="Permalink"></a></h4><p>By default no missing value is added for atmospheric fields. For SURFEX fields either 999 (version ≤ 4) or 1+e20 (version ≥ 5) is used. It is possible to add a missing value via the namelist. To do so, in the namelist set variable lcheck_misval to .TRUE. and set rmisval to the correct value.</p><h4 id="Adding-new-netcdf-variables"><a class="docs-heading-anchor" href="#Adding-new-netcdf-variables">Adding new netcdf variables</a><a id="Adding-new-netcdf-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-new-netcdf-variables" title="Permalink"></a></h4><p>If you get messages like:</p><pre><code class="nohighlight hljs">No NETCDF conversion for ....</code></pre><p>then you need to add the field to <code>util/gl/inc/nc_tab.h</code>, which contains the translation from FA to netcdf names. The file <code>util/gl/inc/trans_tab.h</code> contains the conversion to FA names to GRIB codes. If the field you would like to is absent there, it is probably best to add it in that file as well, as for example GRIB level types are used for functionality in the netcdf conversion as well. Remember to recompile.</p><h2 id="postprocessing"><a class="docs-heading-anchor" href="#postprocessing">postprocessing</a><a id="postprocessing-1"></a><a class="docs-heading-anchor-permalink" href="#postprocessing" title="Permalink"></a></h2><p>gl can be used to produce postprocessed parameters possibly not available directly from the model. </p><ul><li>Postprocessed parameters are defined in <code>util/gl/grb/postprocess.f90</code> and <code>util/gl/grb/postp_pressure_level.f90</code>. Some more popular parameters are listed:<ul><li>Pseudo satellite pictures</li><li>Total precipitation and snow</li><li>Wind (gust) speed and direction</li><li>Cloud base, cloud top, cloud mask and significant cloud top</li></ul></li></ul><p>For a comprehensive list please check the <a href="#gl">output information</a> for each cycle. <strong>NOTE that all parameters may not be implemented in gl</strong></p><ul><li><p>To produce &quot;postprocessed&quot; MSLP and accumulated total precipitation and visibility use the following namelist, <code>nam_FApp</code>:</p><pre><code class="language-bash hljs">&amp;naminterp
 pppkey(1:3)%shortname=&#39;pres&#39;,&#39;tp&#39;,&#39;vis&#39;,
 pppkey(1:3)%levtype=&#39;heightAboveSea&#39;,&#39;heightAboveGround&#39;,&#39;heightAboveGround&#39;
 pppkey(1:3)%level=  0, 0, 0,
 pppkey(1:3)%tri=  0, 4, 0,
 lwrite_pponly= .TRUE.,
/</code></pre><pre><code class="language-bash hljs">gl -p ICMSHHARM+0003 -o output_pp.grib -n nam_FApp</code></pre><ul><li>Note:<ul><li>Set <code>lwrite_pponly</code> as true to only write the postprocessed fields to file</li><li>Set <code>lwrite_pponly</code> as false write all fields will be written to the file, input fields as well as the postprocessed fields.</li></ul></li></ul></li></ul><h2 id="Vertical-interpolation"><a class="docs-heading-anchor" href="#Vertical-interpolation">Vertical interpolation</a><a id="Vertical-interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#Vertical-interpolation" title="Permalink"></a></h2><p>gl can be used to carry out vertical interpolation of parameters. Four types are available</p><ul><li><p>HeightAboveSea, give height above sea in meters</p></li><li><p>HeightAboveGround, give height above ground in meters</p></li><li><p>HeightAboveGroundHighPrecision, give height above ground in centimeters</p></li><li><p>isobaricInHpa, give height above sea in hPa</p></li><li><p>To interpolation temperature to 1.40m (level 140 in cm) use the following namelist, <code>nam_hl</code>:</p><pre><code class="language-bash hljs">&amp;naminterp
 pppkey(1:1)%shortname=&#39;t&#39;,
 pppkey(1:1)%levtype=&#39;heightAboveGroundHighPrecision&#39;,
 pppkey(1:1)%level=  140,
 pppkey(1:1)%tri=  0,
 vint_z_order=1,
 lwrite_pponly= .TRUE.,
/</code></pre><pre><code class="language-bash hljs">gl -p ICMSHHARM+0003 -o output_hl.grib -n nam_hl</code></pre><ul><li>Note:<ul><li>Vertical interpolation to z levels is controlled by VINT<em>Z</em>ORDER: 0 is nearest level, 1 is linear interpolation</li></ul></li></ul></li><li><p>To height interpolation (Levls 500, 850 and 925 in hPa, type=100) use the following namelist, <code>nam_pl</code>:</p><pre><code class="language-bash hljs">&amp;naminterp
 pppkey(1:3)%shortname=&#39;t&#39;,&#39;t&#39;,&#39;t&#39;,
 pppkey(1:3)%levtype=&#39;isobaricInhPa&#39;,&#39;isobaricInhPa&#39;,&#39;isobaricInhPa&#39;,
 pppkey(1:3)%level=  500, 850, 925,
 pppkey(1:3)%tri=  0, 0, 0,
 vint_z_order=1,
 lwrite_pponly= .TRUE.,
/</code></pre><pre><code class="language-bash hljs">gl -p ICMSHHARM+0003 -o output_pl.grib -n nam_pl</code></pre></li></ul><h2 id="Horizontal-interpolation"><a class="docs-heading-anchor" href="#Horizontal-interpolation">Horizontal interpolation</a><a id="Horizontal-interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#Horizontal-interpolation" title="Permalink"></a></h2><ul><li><p>Interpolation/resampling between different geometries such as regular lat lon, Lambert conformal, Polar steregraphic, rotated lat lon and rotated Mercator is possible with gl</p></li><li><p>The interpolation methods available are:</p><ul><li>nearest grid-point (order=-2)</li><li>most representative grid-point (order=-1)</li><li>nearest grid-point (order=0)</li><li>bi-linear (order=1)</li><li>bi-quadratic (order=2, mask not respected)</li><li>bi-cubic (order=3, mask not respected)</li></ul></li><li><p>Example of (an Irish) rotated lat lon domain, <code>nam_FArotll</code>:</p><pre><code class="language-bash hljs">&amp;naminterp
 outgeo%nlon=50,
 outgeo%nlat=50,
 outgeo%nlev=-1,
 outgeo%gridtype=&#39;rotated_ll&#39;,
 outgeo%west=-2.5,
 outgeo%south=-2.5,
 outgeo%dlon=0.1,
 outgeo%dlat=0.1,
 outgeo%polon=-6.7,
 outgeo%polat=-36.2,
 order= 1,
/</code></pre></li></ul><p>where DLON/DLAT are in degrees.The HIRLAM <a href="https://hirlam.github.io/nwptools/domain.html">Domain Tool</a> may be of use for viewing rotated lat lon domains.</p><pre><code class="language-bash hljs">gl -p ICMSHHARM+0003 -n nam_FArotll  -o output.grib</code></pre><ul><li><p>Example of a lambert domain</p><pre><code class="language-bash hljs">&amp;naminterp
  outgeo%nlon       =  50 ,
  outgeo%nlat       =  50,
  outgeo%nlev       =  -1,
  outgeo%gridtype   =  &#39;lambert&#39;,
  outgeo%west       =  15.0
  outgeo%south      =  50.0
  outgeo%dlon       = 10000.
  outgeo%dlat       = 10000.
  outgeo%projlat    =  60.
  outgeo%projlat2   =  60.
  outgeo%projlon    =  15.
/</code></pre><p>where DLON/DLAT are in meters.The HIRLAM <a href="https://hirlam.github.io/nwptools/domain.html">Domain Tool</a> may be of use for viewing rotated lat lon domains.</p></li><li><p>Example polar stereographic projection</p><pre><code class="language-bash hljs">&amp;naminterp
  outgeo%nlon       =  50 ,
  outgeo%nlat       =  50,
  outgeo%nlev       =  -1,
  outgeo%gridtype   =  &#39;polar_stereographic&#39;,
  outgeo%west       =  15.0
  outgeo%south      =  50.0
  outgeo%dlon       = 10000.
  outgeo%dlat       = 10000.
  outgeo%projlat    =  60.
  outgeo%projlon    =  15.
/</code></pre><p>where DLON/DLAT are in meters.Note: the GRIB1 standard assumes that the projection plane is at 60 degrees north whereas HARMONIE assumes it is at 90 degrees north.</p></li><li><p>Example rotated Mercator</p><pre><code class="language-bash hljs">&amp;naminterp
  outgeo%nlon       =  50 ,
  outgeo%nlat       =  50,
  outgeo%nlev       =  -1,
  outgeo%projection =  11,
  outgeo%west       =  15.0
  outgeo%south      =  50.0
  outgeo%dlon       = 10000.
  outgeo%dlat       = 10000.
  outgeo%projlat    =  60.
  outgeo%projlon    =  15.
/</code></pre><p>where DLON/DLAT are in metersNote: rotated Mercator is not supported in GRIB1.</p></li><li><p>Geographical points is a special case of projection 0 use namelist file, <code>nam_FAgp</code>:</p><pre><code class="language-bash hljs">&amp;naminterp
  outgeo%nlon=3 ,
  outgeo%nlat=1,
  outgeo%nlev=-1,
  outgeo%gridtype=&#39;regular_ll&#39;,
  outgeo%arakawa=  &#39;a&#39;,
  order             =   0,
  readkey(1:3)%shortname=&#39;t&#39;,&#39;u&#39;,&#39;v&#39;,
  readkey(1:3)%levtype=&#39;heightAboveGround&#39;,&#39;heightAboveGround&#39;,&#39;heightAboveGround&#39;,
  readkey(1:3)%level=   2,  10, 10,
  readkey(1:3)%tri=  0, 0, 0,
  linterp_field     = f,
  gplat          = 57.375,57.35,57.60
  gplon          = 13.55,13.55,14.63
/</code></pre><p>The result will be written to a ASCII file with the name <code>gpYYYYMMDDHHLLL</code>.</p><pre><code class="language-bash hljs">gl -p ICMSHHARM+0003 -n nam_FAgp 
cat gp20140702_1200+003</code></pre></li></ul><h2 id="Extract-(crop)-a-sub-domain"><a class="docs-heading-anchor" href="#Extract-(crop)-a-sub-domain">Extract (crop) a sub-domain</a><a id="Extract-(crop)-a-sub-domain-1"></a><a class="docs-heading-anchor-permalink" href="#Extract-(crop)-a-sub-domain" title="Permalink"></a></h2><p>gl can be used to &quot;cut out&quot; a sub-domain from an input file using the namelist <code>namCUT</code>:</p><h3 id="Crop-using-lower-left-and-upper-right-coordinates"><a class="docs-heading-anchor" href="#Crop-using-lower-left-and-upper-right-coordinates">Crop using lower left and upper right coordinates</a><a id="Crop-using-lower-left-and-upper-right-coordinates-1"></a><a class="docs-heading-anchor-permalink" href="#Crop-using-lower-left-and-upper-right-coordinates" title="Permalink"></a></h3><pre><code class="language-bash hljs">&amp;naminterp
istart = 150
jstart = 150
istop = 350
jstop = 350
/</code></pre><p>Use this command:</p><pre><code class="language-bash hljs">gl input.grib -n namCut -o cutout.grib</code></pre><p>Another way of specifying your sub domain is to define how many points to exclude in the end</p><pre><code class="language-bash hljs">&amp;naminterp
istart = 150
jstart = 150
istop = -10
jstop = -10
/</code></pre><h3 id="Crop-using-SW,NE-corner-and/or-number-of-points"><a class="docs-heading-anchor" href="#Crop-using-SW,NE-corner-and/or-number-of-points">Crop using SW,NE corner and/or number of points</a><a id="Crop-using-SW,NE-corner-and/or-number-of-points-1"></a><a class="docs-heading-anchor-permalink" href="#Crop-using-SW,NE-corner-and/or-number-of-points" title="Permalink"></a></h3><p>Here, you specify any of the SouthWest, NorthEast corners and/or the number of gridpoints</p><pre><code class="language-bash hljs">&amp;naminterp
outgeo%gridtype = &#39;crop&#39;,
outgeo%nlat  = 200,
outgeo%nlon  = 300,
outgeo%south =  50.155,
outgeo%west  = -12.88,
/</code></pre><p>Or </p><pre><code class="language-bash hljs">&amp;naminterp
outgeo%gridtype = &#39;crop&#39;,
outgeo%north =  58.277,
outgeo%east  =  12.3,
outgeo%south =  50.155,
outgeo%west  = -12.88,
/</code></pre><p>If you specify <code>outgeo%gridtype</code> as &#39;crop&#39;, the SouthWest corner will be translated to lower left grid coordinates and Nlat,Nlon will translate to upper right coordinates.  You may specify any of SW, NE, nlat/nlon.  Priority is given to SW, NE.  The behaviour is as follows:</p><p>SW and NE have priority, these will anchor either corner.  If a corner is not specified, Nlat/Nlon will extend from the other corner.</p><p>If only one coordinate is specified, the other corner becomes the corner of the input domain.  So: </p><ol><li>Specify only SW and you get a crop from there to the NE corner of the  input domain.</li></ol><ol><li><p>Specify only NE and you get a crop from the SW corner of the input  domain.</p></li><li><p>Specify SW and NE and you get a crop between these corners</p></li></ol><ol><li>Specify SW and Nlat/Nlon and you get Nlat x Nlon from SW corner.</li></ol><ol><li>Specify NE and Nlat/Nlon and you get Nlat x Nlon south and west of NE corner.</li></ol><ol><li>Specify SW, NE and Nlat/Nlon and you get a crop between SW/NE corners.  Nlat/Nlon are ignored.</li></ol><ol><li>Specify only Nlat/Nlon and you get Nlat x Nlon from SW corner of the   input domain.</li></ol><p>The crop must be within the original domain unless you set</p><p><code>ldemand_inside = .FALSE.</code></p><p>in the namelist.  In this case, the crop will be adjusted to lie within the original domain and the output will be smaller than Nlat x Nlon.  In the case where the requested crop lies entirely outside the original domain, the program will abort.</p><h2 id="Rotating-wind-components"><a class="docs-heading-anchor" href="#Rotating-wind-components">Rotating wind components</a><a id="Rotating-wind-components-1"></a><a class="docs-heading-anchor-permalink" href="#Rotating-wind-components" title="Permalink"></a></h2><p>HARMONIE produces u and v wind components relative to the model grid. gl by default always outputs u and v relative to the output grid. So if no regridding is done and the output is still on the LCC grid, u and v will also still be relative to the LCC grid. But if the output is regridded to a regular lat-lon grid, then u and v will be rotated and will be relative to the regular lat-lon grid. Wind (from) direction (parameter 31), however, is always relative to a regular lat-lon grid.   To rotate u and v to regular lat-lon, while retaining the data on the LCC grid set <code>uvrelativetogrid=0</code> in the namelist. All u and v vectors that will be processed will be rotated to geographical E and N directions. </p><h2 id="Output-to-several-files"><a class="docs-heading-anchor" href="#Output-to-several-files">Output to several files</a><a id="Output-to-several-files-1"></a><a class="docs-heading-anchor-permalink" href="#Output-to-several-files" title="Permalink"></a></h2><p>It is possible to let gl read data once and do processing loops with these data. Let us look at an example namelist</p><pre><code class="language-bash hljs">&amp;naminterp
 OUTPUT_FORMAT=&#39;MEMORY&#39;
/
&amp;naminterp
 INPUT_FORMAT=&#39;MEMORY&#39;
 OUTPUT_FORMAT=&#39;GRIB&#39;
 OUTFILE=&#39;test1.grib&#39;
/
&amp;naminterp
 INPUT_FORMAT=&#39;MEMORY&#39;
 OUTPUT_FORMAT=&#39;GRIB&#39;
 OUTFILE=&#39;test2.grib&#39;
 READKEY%FANAME=&#39;SNNNTEMPERATURE&#39;
/
&amp;naminterp
 INPUT_FORMAT=&#39;MEMORY&#39;
 OUTPUT_FORMAT=&#39;GRIB&#39;
 READKEY%FANAME=&#39;CLSTEMPERATURE&#39;
 outgeo%nlon       =  50 ,
 outgeo%nlat       =  50,
 outgeo%nlev       =  -1,
 outgeo%gridtype   =  &#39;polar_stereographic&#39;,
 outgeo%west       =  15.0
 outgeo%south      =  50.0
 outgeo%dlon       = 10000.
 outgeo%dlat       = 10000.
 outgeo%projlat    =  60.
 outgeo%projlon    =  15.
 OUTFILE=&#39;test3.grib&#39;
/</code></pre><p>In the first loop we read data and store it in memory. In the second look we read the data from memory and output to the file test1.grib. Then we make two more loops where we in the first one only output a subset and in the last one also do an interpolation to a new grid. The data in memory is however still untouched.</p><h2 id="Input-from-several-files"><a class="docs-heading-anchor" href="#Input-from-several-files">Input from several files</a><a id="Input-from-several-files-1"></a><a class="docs-heading-anchor-permalink" href="#Input-from-several-files" title="Permalink"></a></h2><p>It&#39;s also possible to read several files and write them into one. This is used to gather the various FA fields written from the IO-server. A typical namelist would look like</p><pre><code class="language-bash hljs">&amp;naminterp
 maxfl=28,
 output_format=&#39;MEMORY&#39;,
 output_type = &#39;APPEND&#39;,
 input_format=&#39;FA&#39;,
 infile=&#39;forecast/io_serv.000001.d/ICMSHHARM+0003.gridall&#39;,
/
&amp;naminterp
 output_format=&#39;MEMORY&#39;,
 output_type = &#39;APPEND&#39;,
 input_format=&#39;FA&#39;,
 infile=&#39;forecast/io_serv.000002.d/ICMSHHARM+0003.gridall&#39;,
/
...
&amp;naminterp
 input_format = &#39;MEMORY&#39;,
 output_format= &#39;GRIB&#39;
 output_type  = &#39;NEW&#39;,
 outfile      = &#39;test.grib&#39;
/</code></pre><p>Where maxfl tells how many files that will be read.</p><h2 id="domain_prop"><a class="docs-heading-anchor" href="#domain_prop"><code>domain_prop</code></a><a id="domain_prop-1"></a><a class="docs-heading-anchor-permalink" href="#domain_prop" title="Permalink"></a></h2><p><code>domain_prop</code> is used do extract various properties from a file. </p><pre><code class="nohighlight hljs">Climate:  $MPPGL $BINDIR/domain_prop -DOMAIN_CHECK $LCLIMDIR/m$M1 -f || \</code></pre><h3 id="Check-an-existing-domain-with-a-namelist-specification"><a class="docs-heading-anchor" href="#Check-an-existing-domain-with-a-namelist-specification">Check an existing domain with a namelist specification</a><a id="Check-an-existing-domain-with-a-namelist-specification-1"></a><a class="docs-heading-anchor-permalink" href="#Check-an-existing-domain-with-a-namelist-specification" title="Permalink"></a></h3><pre><code class="language-bash hljs">domain_prop -DOMAIN_CHECK -f CLIMATE_FILE</code></pre><p>The geometry is read from fort.10 and the program aborts if the new and old geometries differs. See  <code>scr/Climate</code> for an example.</p><h3 id="Check-if-Q-is-in-gridpoint-or-spectral-representation"><a class="docs-heading-anchor" href="#Check-if-Q-is-in-gridpoint-or-spectral-representation">Check if Q is in gridpoint or spectral representation</a><a id="Check-if-Q-is-in-gridpoint-or-spectral-representation-1"></a><a class="docs-heading-anchor-permalink" href="#Check-if-Q-is-in-gridpoint-or-spectral-representation" title="Permalink"></a></h3><pre><code class="language-bash hljs">domain_prop -f -QCHECK FAFILE</code></pre><p>returns 1 if Q is spectral and 0 if Q is in gridpoint space.</p><h3 id="Check-if-a-specific-field-is-present"><a class="docs-heading-anchor" href="#Check-if-a-specific-field-is-present">Check if a specific field is present</a><a id="Check-if-a-specific-field-is-present-1"></a><a class="docs-heading-anchor-permalink" href="#Check-if-a-specific-field-is-present" title="Permalink"></a></h3><pre><code class="language-bash hljs">domain_prop -f -CHECK_FIELD S001CLOUD_FRACTI</code></pre><p>returns 1 if <code>S001CLOUD_FRACTI</code> is found, 0 otherwise</p><h3 id="Check-the-number-of-levels-in-a-file"><a class="docs-heading-anchor" href="#Check-the-number-of-levels-in-a-file">Check the number of levels in a file</a><a id="Check-the-number-of-levels-in-a-file-1"></a><a class="docs-heading-anchor-permalink" href="#Check-the-number-of-levels-in-a-file" title="Permalink"></a></h3><pre><code class="language-bash hljs">domain_prop -f -NLEV FAFILE  </code></pre><h3 id="Check-the-geographical-extension-of-the-domain"><a class="docs-heading-anchor" href="#Check-the-geographical-extension-of-the-domain">Check the geographical extension of the domain</a><a id="Check-the-geographical-extension-of-the-domain-1"></a><a class="docs-heading-anchor-permalink" href="#Check-the-geographical-extension-of-the-domain" title="Permalink"></a></h3><pre><code class="language-bash hljs">domain_prop -f -MAX_EXT FAFILE  </code></pre><p>This is used in several places to determine the domain to be extracted from MARS or limit the observations sample. Another way is to provide the projection parameters of your domain as input</p><pre><code class="language-bash hljs">domain_prop -MAX_EXTR \
-NLON $NLON -NLAT $NLAT \
-LATC $LATC -LONC $LONC \
-LAT0 $LAT0 -LON0 $LON0 \
-GSIZE $GSIZE</code></pre><p>To get the geographical position of the lower left corner use</p><pre><code class="language-bash hljs">domain_prop -f -LOW_LEFT FAFILE  </code></pre><p>To print out the important projection parameters in a file use:</p><pre><code class="language-bash hljs">domain_prop -f -4JB FAFILE</code></pre><h3 id="Get-time-information-from-a-file"><a class="docs-heading-anchor" href="#Get-time-information-from-a-file">Get time information from a file</a><a id="Get-time-information-from-a-file-1"></a><a class="docs-heading-anchor-permalink" href="#Get-time-information-from-a-file" title="Permalink"></a></h3><pre><code class="language-bash hljs">domain_prop -f -DATE FAFILE</code></pre><h2 id="fldextr-and-obsextr"><a class="docs-heading-anchor" href="#fldextr-and-obsextr">fldextr and obsextr</a><a id="fldextr-and-obsextr-1"></a><a class="docs-heading-anchor-permalink" href="#fldextr-and-obsextr" title="Permalink"></a></h2><p>Read about the verification extraction programs <a href="../../Verification/Extract4verification/#extract4verification">here</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Fullpos/">« FullPos</a><a class="docs-footer-nextpage" href="../xtool/">xtool »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Friday 19 July 2024 08:06">Friday 19 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
