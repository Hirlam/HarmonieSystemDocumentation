<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ECFLOW · Harmonie wiki</title><meta name="title" content="ECFLOW · Harmonie wiki"/><meta property="og:title" content="ECFLOW · Harmonie wiki"/><meta property="twitter:title" content="ECFLOW · Harmonie wiki"/><meta name="description" content="Documentation for Harmonie wiki."/><meta property="og:description" content="Documentation for Harmonie wiki."/><meta property="twitter:description" content="Documentation for Harmonie wiki."/><meta property="og:url" content="https://hirlam.github.io/HarmonieSystemDocumentation/dev/SuiteManagement/ECFLOW/"/><meta property="twitter:url" content="https://hirlam.github.io/HarmonieSystemDocumentation/dev/SuiteManagement/ECFLOW/"/><link rel="canonical" href="https://hirlam.github.io/HarmonieSystemDocumentation/dev/SuiteManagement/ECFLOW/"/><script async src="https://www.googletagmanager.com/gtag/js?id=G-HQ1BCP3LPJ"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HQ1BCP3LPJ', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Harmonie wiki logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Harmonie wiki</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../System/GitDeveloperDocumentation/">GitHub workflow</a></li><li><a class="tocitem" href="../../Overview/da_graph/">Graphical Overview</a></li><li><a class="tocitem" href="../../System/ECMWF/RunningHarmonieOnAtos/">Running on Atos</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Overview</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Overview/Content/">Content</a></li><li><a class="tocitem" href="../../Overview/Binaries/">Binaries</a></li><li><a class="tocitem" href="../../Overview/FileFormats/">File Formats</a></li><li><a class="tocitem" href="../../Overview/Source/">Source</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Experiment Configuration</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ExperimentConfiguration/ConfigureYourExperiment/">Experiment</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/Namelists/">Namelist</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/UseofObservation/">Observations</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/PlatformConfiguration/">Platform</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/How_to_use_hires_topography/">HiRes Topography</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/ModelDomain/">Domain</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/VerticalGrid/">Vertical Grid</a></li></ul></li></ul></li><li><span class="tocitem">NWP Components</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Observations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1-1"><span class="docs-label">Preprocessing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Observations/ObservationPreprocessing/">Preprocessing</a></li><li><a class="tocitem" href="../../Observations/Oulan/">Oulan</a></li><li><a class="tocitem" href="../../Observations/Bator/">Bator</a></li><li><a class="tocitem" href="../../Observations/Cope/">Cope</a></li><li><a class="tocitem" href="../../Observations/ObservationData/">ObservationData</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Observations/SYNOP/">SYNOP</a></li><li><a class="tocitem" href="../../Observations/Amv/">AMV</a></li><li><a class="tocitem" href="../../Observations/Atovs/">ATOVS</a></li><li><a class="tocitem" href="../../Observations/Iasi/">IASI</a></li><li><a class="tocitem" href="../../Observations/Seviri/">SEVIRI</a></li><li><a class="tocitem" href="../../Observations/Scatt/">Scatt</a></li><li><a class="tocitem" href="../../Observations/Ascat/">AScat</a></li><li><a class="tocitem" href="../../Observations/GNSS/">GNSS</a></li><li><a class="tocitem" href="../../Observations/Modes/">Modes</a></li><li><a class="tocitem" href="../../Observations/RadarData/">Radar</a></li><li><a class="tocitem" href="../../Observations/Aeolus/">Aeolus</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Data Assimilation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-2-1" type="checkbox"/><label class="tocitem" for="menuitem-3-2-1"><span class="docs-label">Surface</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI/">CANARI</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI_OI_MAIN/">CANARI OI MAIN</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI_EKF_SURFEX/">CANARI EKF SURFEX</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/SurfaceAnalysis/">Surface Analysis</a></li></ul></li><li><a class="tocitem" href="../../DataAssimilation/Screening/">Screening</a></li><li><a class="tocitem" href="../../DataAssimilation/StructureFunctions/">Structure functions</a></li><li><a class="tocitem" href="../../DataAssimilation/DaAlgorithms/">Algorithms</a></li><li><a class="tocitem" href="../../DataAssimilation/DigitalFilterInitialization/">Digital Filter Initialization</a></li><li><a class="tocitem" href="../../DataAssimilation/ObservationOperators/">HOP_DRIVER</a></li><li><a class="tocitem" href="../../DataAssimilation/SingleObs/">Single Obs</a></li><li><a class="tocitem" href="../../DataAssimilation/LSMIXandJk/">LSMIX and Jk</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-3-1"><span class="docs-label">Data Assimilation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/DFS/">DFS</a></li><li><a class="tocitem" href="../../DataAssimilation/MTEN/">MTEN</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-3-2"><span class="docs-label">Forecast(spin-up)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/CHKEVO/">CHKEVO</a></li><li><a class="tocitem" href="../../DataAssimilation/NWECHKEVO/">NWECHKEVO</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Boundaries</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Boundaries/BoundaryFilePreparation/">Preparation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Forecast Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ForecastModel/Forecast/">Forecast</a></li><li><a class="tocitem" href="../../ForecastModel/ForecastSettings/">Settings</a></li><li><a class="tocitem" href="../../ForecastModel/Outputlist/">Output List</a></li><li><a class="tocitem" href="../../ForecastModel/HR/">High Res</a></li><li><input class="collapse-toggle" id="menuitem-3-5-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5-5"><span class="docs-label">Single Column Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC/">MUSC</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/Forcing/">Forcing</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC_EMS/">MUSC EMS</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC_vars/">MUSC vars</a></li></ul></li><li><a class="tocitem" href="../../ForecastModel/WindFarms/">Wind Farm Parameterisation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Climate Generation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ClimateGeneration/ClimateGeneration/">Climate Generation</a></li><li><a class="tocitem" href="../../ClimateGeneration/DownloadInputData/">Input Data</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">EPS</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../EPS/Howto/">Howto</a></li><li><a class="tocitem" href="../../EPS/System/">System</a></li><li><a class="tocitem" href="../../EPS/BDSTRATEGY/">BDSTRATEGY</a></li><li><a class="tocitem" href="../../EPS/SLAF/">SLAF</a></li><li><a class="tocitem" href="../../EPS/SPP/">SPP</a></li><li><a class="tocitem" href="../../EPS/SPPT/">SPPT</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-8" type="checkbox"/><label class="tocitem" for="menuitem-3-8"><span class="docs-label">Post Processing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../PostProcessing/Diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../../PostProcessing/FileConversions/">FileConversions</a></li><li><a class="tocitem" href="../../PostProcessing/Fullpos/">FullPos</a></li><li><a class="tocitem" href="../../PostProcessing/gl/">GL</a></li><li><a class="tocitem" href="../../PostProcessing/xtool/">xtool</a></li><li><a class="tocitem" href="../../PostProcessing/Interpolation/">Interpolation GL</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-9" type="checkbox"/><label class="tocitem" for="menuitem-3-9"><span class="docs-label">Verification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Verification/Extract4verification/">Extract4verification</a></li><li><a class="tocitem" href="../../Verification/Verification/">Verification</a></li><li><a class="tocitem" href="../../Verification/HARP/">HARP</a></li><li><a class="tocitem" href="../../Verification/Obsmon/">Obsmon</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-10" type="checkbox"/><label class="tocitem" for="menuitem-3-10"><span class="docs-label">Visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Visualization/EPyGrAM/">EpyGram</a></li></ul></li></ul></li><li><span class="tocitem">System</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Build</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Build/Build_with_cmake/">CMake</a></li><li><a class="tocitem" href="../../Build/Build_with_makeup/">Makeup</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Phasing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../System/MFaccess/">MF Access</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox" checked/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Suite Management</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>ECFLOW</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#ecFlow-control"><span>ecFlow control</span></a></li><li><a class="tocitem" href="#More-info"><span>More info</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../System/TheHarmonieScript/">The Harmonie script</a></li><li><a class="tocitem" href="../../System/ECMWF/RunningHarmonieOnAtos/">Running on ECMWF&#39;s Atos</a></li><li><a class="tocitem" href="../../System/ReleaseProcess/">Harmonie release process</a></li><li><a class="tocitem" href="../../System/Local/QuickStartLocal/">Local</a></li><li><a class="tocitem" href="../../System/HarmonieTestbed/">Testbed</a></li><li><a class="tocitem" href="../../System/ECMWF/ECMWF_teleport/">Teleport</a></li><li><a class="tocitem" href="../../System/Build_local_docs/">Local Documentation</a></li><li><a class="tocitem" href="../../System/DrHook/">DrHook</a></li><li><a class="tocitem" href="../../System/StandaloneOdb/">Stand alone ODB</a></li><li><a class="tocitem" href="../../System/UpdateNamelists/">Update Namelist</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">System</a></li><li><a class="is-disabled">Suite Management</a></li><li class="is-active"><a href>ECFLOW</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ECFLOW</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Hirlam/Harmonie" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Hirlam/Harmonie/blob/dev-CY46h1/docs/src/SuiteManagement/ECFLOW.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ecflow"><a class="docs-heading-anchor" href="#ecflow">Running Harmonie under ecFlow</a><a id="ecflow-1"></a><a class="docs-heading-anchor-permalink" href="#ecflow" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>This document describes how to run Harmonie under ecFlow scheduler at ECMWF. ecFlow is the ECMWF workflow manager and it has been written using python to improve maintainability, allow easier modification and introduce object orientated features as compared to the old scheduler SMS. ecFlow can be used in any HARMONIE version in and above harmonie-40h1.1.beta.1.</p><h3 id="New-users"><a class="docs-heading-anchor" href="#New-users">New users</a><a id="New-users-1"></a><a class="docs-heading-anchor-permalink" href="#New-users" title="Permalink"></a></h3><p>On the ECMWF Atos machine in Bologna, each user has a virtual machine on which ecFlow is running. If you don&#39;t have a VM yet, ask ECMWF to set it up for you. If you are starting ecFlow for the first time at ECMWF, you may have to add your ssh key to the authorized_keys file to allow passwordless access, as ssh is used to communicate between the servers:</p><pre><code class="language-bash hljs">      cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</code></pre><h3 id="Start-your-experiment-supervised-by-ecFlow"><a class="docs-heading-anchor" href="#Start-your-experiment-supervised-by-ecFlow">Start your experiment supervised by ecFlow</a><a id="Start-your-experiment-supervised-by-ecFlow-1"></a><a class="docs-heading-anchor-permalink" href="#Start-your-experiment-supervised-by-ecFlow" title="Permalink"></a></h3><p>Launch the experiment in the usual manner by giving start time, <code>DTG</code>, end time, <code>DTGEND</code> and other optional arguments</p><pre><code class="language-bash hljs">      ~hlam/Harmonie start DTG=YYYYMMDDHH</code></pre><p>If successful, ecFlow will identify your experiment name and start building your binaries and run your forecast. If not, you need to examine the ecFlow log file <code>$HM_DATA/ECF.log</code>. <code>$HM_DATA</code> is defined in your <code>Env_system</code> file. At ECMWF <code>$HM_DATA=$SCRATCH/hm_home/$EXP</code> where <code>$EXP</code> is your experiment name.</p><p>The ecFlow viewer starts automatically. To view any suite for your server or other servers, the server must be added to the ecFlow viewer (via Servers -&gt; Manage servers, Add server) and selected in Servers. See below on how to find the port and server name.</p><ul><li>More than one experiment is not allowed with the same name monitored in the same server so Harmonie will start the server and delete previous non-active suite for you.</li><li>For deleting a suite manually using <code>ecflow_client --port XXXX --host XXXX --delete force yes /suite</code> or using the GUI: right-click on the suite, then click &quot;Remove&quot; (if you don&#39;t see the Remove option, go to Tools -&gt; Preferences -&gt; Menus, and make yourself Administrator)</li><li>If other manual intervention in server or client is needed you can use ecflow commands. See <a href="https://ecflow.readthedocs.io/en/latest/index.html">here</a>.</li></ul><h2 id="ecFlow-control"><a class="docs-heading-anchor" href="#ecFlow-control">ecFlow control</a><a id="ecFlow-control-1"></a><a class="docs-heading-anchor-permalink" href="#ecFlow-control" title="Permalink"></a></h2><h3 id="Finding-the-port-and-host-of-the-ecFlow-server"><a class="docs-heading-anchor" href="#Finding-the-port-and-host-of-the-ecFlow-server">Finding the port and host of the ecFlow server</a><a id="Finding-the-port-and-host-of-the-ecFlow-server-1"></a><a class="docs-heading-anchor-permalink" href="#Finding-the-port-and-host-of-the-ecFlow-server" title="Permalink"></a></h3><p>The server on which ecFlow is running is defined with variable <code>$ECF_HOST</code>, the port with <code>ECF_PORT</code>, set in <code>Env_system</code> or derived. On the VMs on ECMWF Atos machine in Bologna <code>ECF_HOST=ecflow-gen-${USER}-001</code> and <code>ECF_PORT=3141</code> for all users.</p><p>Information about server variables can be found by running:</p><ul><li>On ECMWF&#39;s Atos:</li></ul><pre><code class="language-bash hljs">      ssh ecflow-gen-${USER}-001 ecflow_server status </code></pre><ul><li>Or if ecFlow is running on the machine you are logged into:</li></ul><pre><code class="language-bash hljs">      ecflow_server status </code></pre><p>You can also find <code>ECF_PORT</code>/<code>ECF_HOST</code> by checking the files under <code>$ECF_HOME</code>, like:</p><pre><code class="language-bash hljs">&gt; ls -rlt ~/ecflow_server
total 12
-rw-r--r-- 1 hlam accord 2529 Jun 15 16:20 ecflow-gen-hlam-001.3141.ecf.check.b
-rw-r--r-- 1 hlam accord 2529 Jun 20 17:36 ecflow-gen-hlam-001.3141.ecf.check
-rw-r--r-- 1 hlam accord 3113 Jun 20 17:38 ecflow-gen-hlam-001.log</code></pre><h3 id="Check-the-status-of-your-server"><a class="docs-heading-anchor" href="#Check-the-status-of-your-server">Check the status of your server</a><a id="Check-the-status-of-your-server-1"></a><a class="docs-heading-anchor-permalink" href="#Check-the-status-of-your-server" title="Permalink"></a></h3><p>To check the status of your server you can use</p><pre><code class="language-bash hljs">ecflow_client --stats  --port ECF_PORT  --host ECF_HOST</code></pre><p>or</p><pre><code class="language-bash hljs">ecflow_client --port ECF_PORT  --host ECF_HOST  --ping</code></pre><p>or go to the &quot;Info&quot; tab in the ecFlow viewer.</p><h3 id="Open-the-viewer-of-a-running-ecFlow-server"><a class="docs-heading-anchor" href="#Open-the-viewer-of-a-running-ecFlow-server">Open the viewer of a running ecFlow server</a><a id="Open-the-viewer-of-a-running-ecFlow-server-1"></a><a class="docs-heading-anchor-permalink" href="#Open-the-viewer-of-a-running-ecFlow-server" title="Permalink"></a></h3><p>If you know that your ecFlow server is running but you have no viewer attached to it you can restart the viewer:</p><pre><code class="language-bash hljs">ecflow_ui &amp;</code></pre><h3 id="Stop-your-ecFlow-server"><a class="docs-heading-anchor" href="#Stop-your-ecFlow-server">Stop your ecFlow server</a><a id="Stop-your-ecFlow-server-1"></a><a class="docs-heading-anchor-permalink" href="#Stop-your-ecFlow-server" title="Permalink"></a></h3><p>If you are sure you&#39;re running the server on the login node of your machine you can simply run</p><pre><code class="language-bash hljs">ecflow_stop.sh</code></pre><p>A more complete and robust way is</p><pre><code class="language-bash hljs">export ECF_PORT=&lt;your port&gt;
export ECF_HOST=&lt;your server name&gt;
ecflow_client  --halt=yes
ecflow_client  --check_pt
ecflow_client  --terminate=yes</code></pre><h3 id="Restart-your-ecFlow-server"><a class="docs-heading-anchor" href="#Restart-your-ecFlow-server">Restart your ecFlow server</a><a id="Restart-your-ecFlow-server-1"></a><a class="docs-heading-anchor-permalink" href="#Restart-your-ecFlow-server" title="Permalink"></a></h3><p>The ecFlow servers on the virtual machines a ECMWF should be restarted automatically. If it doesn&#39;t, you may need to restart it with:</p><pre><code class="language-bash hljs">ssh ecflow-gen-${USER}-001 sudo systemctl restart ecflow-server</code></pre><p>On other systems, if the server is not running you can start again using the script:</p><pre><code class="language-bash hljs"> ecflow_start.sh [-d $ECF_HOME]</code></pre><p>If ecFlow is running on a different machine you have to login and start it on that machine:</p><pre><code class="language-bash hljs"> ssh &lt;your server name&gt;
 module load ecflow
 ecflow_start.sh [-d $ECF_HOME]</code></pre><p>As an alternative you can let Harmonie start the server for you when starting your next experiment, or type</p><pre><code class="language-bash hljs">~hlam/Harmonie mon</code></pre><h3 id="Keep-your-ecFlow-server-alive"><a class="docs-heading-anchor" href="#Keep-your-ecFlow-server-alive">Keep your ecFlow server alive</a><a id="Keep-your-ecFlow-server-alive-1"></a><a class="docs-heading-anchor-permalink" href="#Keep-your-ecFlow-server-alive" title="Permalink"></a></h3><p>If not using ecFlow at the ECMWF&#39;s VMs, the ecFlow server will eventually die causing an unexpected disruption in you experiments. To prevent this you can add a cron job restarting the server e.g. every fifth minute.</p><pre><code class="language-bash hljs">&gt; crontab -l
*/5 * * * * /home/$USER/bin/cronrun.sh ecflow_start.sh -d $ECF_HOME &gt; ~/ecflow_start.out 2&gt;&amp;1</code></pre><p>where tthe small script <code>cronrun.sh</code> makes sure you get the right environment</p><pre><code class="language-bash hljs">#!/bin/bash
source ~/.bash_profile
module unload ecflow
module load ecflow/5.7.0
$@</code></pre><p>The ecFlow server version may change over time.</p><h3 id="Add-another-user-to-your-ecFlow-viewer"><a class="docs-heading-anchor" href="#Add-another-user-to-your-ecFlow-viewer">Add another user to your ecFlow viewer</a><a id="Add-another-user-to-your-ecFlow-viewer-1"></a><a class="docs-heading-anchor-permalink" href="#Add-another-user-to-your-ecFlow-viewer" title="Permalink"></a></h3><p>Sometimes it&#39;s handy to be able to follow, and control, your colleagues experiments. To be able to do this do the following steps:</p><ul><li>Find the port number of your colleague as described above.</li><li>In the ecFlow viewer choose Servers -&gt; Manage servers, click on &quot;Add server&quot; and fill in the appropriate host and port and give it a useful name. Click on OK to save it.</li><li>If you click on Servers in the viewer the name should appear and you can make it visible by clicking on it.</li></ul><h3 id="Changing-the-port"><a class="docs-heading-anchor" href="#Changing-the-port">Changing the port</a><a id="Changing-the-port-1"></a><a class="docs-heading-anchor-permalink" href="#Changing-the-port" title="Permalink"></a></h3><p>By default, the port is set by </p><pre><code class="language-bash hljs">export ECF_PORT=$((1500+usernumber))</code></pre><p>in <code>mSMS.job</code> (40h1.1), <code>Start_ecFlow.sh</code> (up to #b6d58dd), or <code>Main</code> (currently).</p><p>For the VMs at ECMWF it is set to 3141 in <code>Env_system</code>. If you want to change this number (for example, if that port is in use already), you will also need to add a -p flag when calling <code>ecflow_start.sh</code> as follows:</p><pre><code class="language-bash hljs">ecflow_start.sh -p $ECF_PORT -d $JOBOUTDIR</code></pre><p>Otherwise, <code>ecflow_start.sh</code> tries to open the default port.</p><p>Note: if you already have an ecFlow server running at your new port number before launching an experiment, this won&#39;t be an issue. </p><h2 id="More-info"><a class="docs-heading-anchor" href="#More-info">More info</a><a id="More-info-1"></a><a class="docs-heading-anchor-permalink" href="#More-info" title="Permalink"></a></h2><ul><li><a href="https://confluence.ecmwf.int/display/ECFLOW/ecflow+home">ECMWF&#39;s ecFlow documentation</a></li><li><a href="https://confluence.ecmwf.int/display/UDOC/HPC2020%3A+Using+ecFlow">ecFlow at ECMWF&#39;s ATOS</a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../System/MFaccess/">« MF Access</a><a class="docs-footer-nextpage" href="../../System/TheHarmonieScript/">The Harmonie script »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.0.1 on <span class="colophon-date" title="Wednesday 21 February 2024 08:17">Wednesday 21 February 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
