<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>SourceCodeReposity · Harmonie wiki</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Harmonie wiki logo"/></a><div class="docs-package-name"><span class="docs-autofit">Harmonie wiki</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../GitDeveloperDocumentation/">GitHub workflow</a></li><li><a class="tocitem" href="../../Overview/da_graph/">Graphical Overview</a></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Overview</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Overview/Content/">Content</a></li><li><a class="tocitem" href="../../Overview/Binaries/">Binaries</a></li><li><a class="tocitem" href="../../Overview/FileFormats/">File Formats</a></li><li><a class="tocitem" href="../../Overview/Source/">Source</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Quick Start</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../QuickStart/TheHarmonieScript/">The Harmonie script</a></li><li><input class="collapse-toggle" id="menuitem-2-4-2" type="checkbox"/><label class="tocitem" for="menuitem-2-4-2"><span class="docs-label">ECMWF</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../QuickStart/Fast_start_on_cca/">Fast start on cca</a></li></ul></li><li><a class="tocitem" href="../../QuickStart/QuickStartLocal/">Local</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Experiment Configuration</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ExperimentConfiguration/ConfigureYourExperiment/">Experiment</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/Namelists/">Namelist</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/UseofObservation/">Observations</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/PlatformConfiguration/">Platform</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/How_to_use_hires_topography/">HiRes Topography</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/ModelDomain/">Domain</a></li><li><a class="tocitem" href="../../ExperimentConfiguration/VerticalGrid/">Vertical Grid</a></li></ul></li></ul></li><li><span class="tocitem">NWP Components</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Observations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1-1"><span class="docs-label">Preprocessing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Observations/ObservationPreprocessing/">Preprocessing</a></li><li><a class="tocitem" href="../../Observations/Oulan/">Oulan</a></li><li><a class="tocitem" href="../../Observations/Bator/">Bator</a></li><li><a class="tocitem" href="../../Observations/Cope/">Cope</a></li><li><a class="tocitem" href="../../Observations/ObservationData/">ObservationData</a></li><li><a class="tocitem" href="../../Observations/Conrad/">Conrad</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Observations/SYNOP/">SYNOP</a></li><li><a class="tocitem" href="../../Observations/Amv/">AMV</a></li><li><a class="tocitem" href="../../Observations/Iasi/">IASI</a></li><li><a class="tocitem" href="../../Observations/Atovs/">ATOVS</a></li><li><a class="tocitem" href="../../Observations/Scatt/">Scatt</a></li><li><a class="tocitem" href="../../Observations/Ascat/">AScat</a></li><li><a class="tocitem" href="../../Observations/GNSS/">GNSS</a></li><li><a class="tocitem" href="../../Observations/Modes/">Modes</a></li><li><a class="tocitem" href="../../Observations/RadarData/">Radar</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Data Assimilation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-2-1" type="checkbox"/><label class="tocitem" for="menuitem-3-2-1"><span class="docs-label">Surface</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI/">CANARI</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI_OI_MAIN/">CANARI OI MAIN</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/CANARI_EKF_SURFEX/">CANARI EKF SURFEX</a></li><li><a class="tocitem" href="../../DataAssimilation/Surface/SurfaceAnalysis/">Surface Analysis</a></li></ul></li><li><a class="tocitem" href="../../DataAssimilation/Screening/">Screening</a></li><li><a class="tocitem" href="../../DataAssimilation/StructureFunctions/">Structure functions</a></li><li><a class="tocitem" href="../../DataAssimilation/DataAssimilation4DVAR/">4DVAR</a></li><li><a class="tocitem" href="../../DataAssimilation/DigitalFilterInitialization/">Digital Filter Initialization</a></li><li><a class="tocitem" href="../../DataAssimilation/ObservationOperators/">HOP_DRIVER</a></li><li><a class="tocitem" href="../../DataAssimilation/SingleObs/">Single Obs</a></li><li><a class="tocitem" href="../../DataAssimilation/LSMIXandJk/">LSMIX and Jk</a></li><li><a class="tocitem" href="../../DataAssimilation/DFS/">DFS</a></li><li><a class="tocitem" href="../../DataAssimilation/MTEN/">MTEN</a></li><li><a class="tocitem" href="../../DataAssimilation/CHKEVO/">CHKEVO</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Boundaries</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Boundaries/BoundaryFilePreparation/">Preparation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Forecast Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ForecastModel/Forecast/">Forecast</a></li><li><a class="tocitem" href="../../ForecastModel/Outputlist/">Output List</a></li><li><a class="tocitem" href="../../ForecastModel/HR/">High Res</a></li><li><input class="collapse-toggle" id="menuitem-3-4-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4-4"><span class="docs-label">Single Column Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC/">MUSC</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/Forcing/">Forcing</a></li><li><a class="tocitem" href="../../ForecastModel/SingleColumnModel/MUSC_vars/">MUSC vars</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Climate Generation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ClimateGeneration/ClimateGeneration/">Climate Generation</a></li><li><a class="tocitem" href="../../ClimateGeneration/DownloadInputData/">Input Data</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">EPS</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../EPS/Howto/">Howto</a></li><li><a class="tocitem" href="../../EPS/System/">System</a></li><li><a class="tocitem" href="../../EPS/BDSTRATEGY/">BDSTRATEGY</a></li><li><a class="tocitem" href="../../EPS/SLAF/">SLAF</a></li><li><a class="tocitem" href="../../EPS/SPP/">SPP</a></li><li><a class="tocitem" href="../../EPS/SPPT/">SPPT</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Post Processing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../PostProcessing/Diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../../PostProcessing/FileConversions/">FileConversions</a></li><li><a class="tocitem" href="../../PostProcessing/Fullpos/">FullPos</a></li><li><a class="tocitem" href="../../PostProcessing/gl/">GL</a></li><li><a class="tocitem" href="../../PostProcessing/xtool/">xtool</a></li><li><a class="tocitem" href="../../PostProcessing/PostPP/">PostPP</a></li><li><a class="tocitem" href="../../PostProcessing/Interpolation/">Interpolation GL</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-8" type="checkbox"/><label class="tocitem" for="menuitem-3-8"><span class="docs-label">Verification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Verification/Extract4verification/">Extract4verification</a></li><li><a class="tocitem" href="../../Verification/Verification/">Verification</a></li><li><a class="tocitem" href="../../Verification/HARP/">HARP</a></li><li><a class="tocitem" href="../../Verification/Obsmon/">Obsmon</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-9" type="checkbox"/><label class="tocitem" for="menuitem-3-9"><span class="docs-label">Visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Visualization/EPyGrAM/">EpyGram</a></li></ul></li></ul></li><li><span class="tocitem">System</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Build</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Build/General/">Software requirements</a></li><li><a class="tocitem" href="../../Build/Build_with_makeup/">Makeup</a></li><li><a class="tocitem" href="../../Build/gmkpack/">Gmkpack</a></li><li><a class="tocitem" href="../../Build/Gmkpack_vs_Make/">Gmkpack vs Make</a></li><li><a class="tocitem" href="../../Build/CompileHarmonie/">Compile Harmonie</a></li><li><a class="tocitem" href="../../Build/Installation/">Installation</a></li><li><a class="tocitem" href="../../Build/Redhat7Install/">Redhat7 Install</a></li><li><a class="tocitem" href="../../Build/Centos6Install/">Centos6 Install</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Phasing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../MFaccess/">MF Access</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Suite Management</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../SuiteManagement/ECFLOW/">ECFLOW</a></li></ul></li><li><a class="tocitem" href="../HarmonieTestbed/">Testbed</a></li><li class="is-active"><a class="tocitem" href>SourceCodeReposity</a><ul class="internal"><li><a class="tocitem" href="#Overview-1"><span>Overview</span></a></li><li><a class="tocitem" href="#User-Access-1"><span>User Access</span></a></li><li><a class="tocitem" href="#Repository-Structure-1"><span>Repository Structure</span></a></li><li><a class="tocitem" href="#From-svn-to-git-1"><span>From svn to git</span></a></li></ul></li><li><a class="tocitem" href="../ECMWF_teleport/">Teleport</a></li><li><a class="tocitem" href="../DrHook/">DrHook</a></li><li><a class="tocitem" href="../StandaloneOdb/">Stand alone ODB</a></li><li><a class="tocitem" href="../UpdateNamelists/">Update Namelist</a></li><li><a class="tocitem" href="../Scalability_and_Refactoring/">Scalability and refactoring</a></li><li><a class="tocitem" href="../HarmonieBenchMark/">Benchmark</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">System</a></li><li class="is-active"><a href>SourceCodeReposity</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>SourceCodeReposity</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Hirlam/Harmonie/blob/pre-CY46h1/docs/src/System/SourceCodeRepository.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Harmonie-Source-Code-Repository-1"><a class="docs-heading-anchor" href="#Harmonie-Source-Code-Repository-1">Harmonie Source Code Repository</a><a class="docs-heading-anchor-permalink" href="#Harmonie-Source-Code-Repository-1" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>See <a href="../GitDeveloperDocumentation/">here</a> for the new github based workflow. </p></div></div><h2 id="Overview-1"><a class="docs-heading-anchor" href="#Overview-1">Overview</a><a class="docs-heading-anchor-permalink" href="#Overview-1" title="Permalink"></a></h2><p>This page contains informations about the source code repository for code revision control of the Harmonie model.</p><p>The informations refer to the new code repository administrated under <a href="https://git-scm.com">git</a></p><h2 id="User-Access-1"><a class="docs-heading-anchor" href="#User-Access-1">User Access</a><a class="docs-heading-anchor-permalink" href="#User-Access-1" title="Permalink"></a></h2><p>In general, all users with access to hirlam.org have read access to the central public Harmonie repository, but only the system-core staff is granted write access. In order to facilitate repository sharing for all users, each user can establish a user repository, and a <em>fork</em> of the official repositories like the Harmonie repository.</p><h3 id="Forking-and-Cloning-#forking-1"><a class="docs-heading-anchor" href="#Forking-and-Cloning-#forking-1">Forking and Cloning #forking</a><a class="docs-heading-anchor-permalink" href="#Forking-and-Cloning-#forking-1" title="Permalink"></a></h3><h3 id="General-Proceduce-1"><a class="docs-heading-anchor" href="#General-Proceduce-1">General Proceduce</a><a class="docs-heading-anchor-permalink" href="#General-Proceduce-1" title="Permalink"></a></h3><p>A fork of the Harmonie git repository is just a clone of the repo on hirlam.org, but optimizing storage resource use. On hirlam.org, the fork is established within the users repository area &#39;users/&lt;username&gt;&#39;. In order to perform the forking, ssh access is necessary:</p><pre><code class="language-bash">ssh git@hirlam.org fork Harmonie users/&lt;your username&gt;/Harmonie</code></pre><p>Unfortunately, users don&#39;t have ssh access to &#39;git&#39; on hirlam.org, unless a public ssh key is being provided and registered. The corresponding personal ssh key has to be used then in order to execute the above ssh command, and in case this one is not the default ssh key on the user&#39;s local system, it has to be provided via ssh option <code>-i</code>.</p><p>Once the fork is established, the user can clone from this [#shareduserrepo user repository]: [=#forkclone]</p><pre><code class="language-bash">git clone git@hirlam.org:users/&lt;your username&gt;/Harmonie $HOME/repo/users/&lt;your username&gt;/Harmonie</code></pre><p>Either of these commands establishes the repository on the local filesystem, with the <em>origin</em> pointing to the user&#39;s repository. So <em>pushing</em> will happen onto the //user repository//, and not onto the public repository. Nevertheless, the //user repository// is generally readable for all users on hirlam.org, and thus acts as a repository for [#sharing sharing].</p><blockquote><p>It is important to note that the forked repository on hirlam.org is <em>not</em> automatically updated with updates from the original repository</p></blockquote><p>Updating your forked repository on hirlam.org happens through your local repository, and this is controlled by yourself. In order to be able to do this, however, your local repository needs to be explicitly //connected// to the public repository by establishment of a <em>remote</em>:</p><pre><code class="language-bash">   cd $HOME/repo/users/&lt;your username&gt;/Harmonie
   git remote add public git@hirlam.org:Harmonie</code></pre><p>Check the list of <em>remotes</em> within your local user repo by: [=#remotelist]</p><pre><code class="language-bash">   git remote -v</code></pre><p>This should then show a listing like:</p><pre><code class="language-bash">   origin  git@hirlam.org:users/&lt;your username&gt;/Harmonie (fetch)
   origin  git@hirlam.org:users/&lt;your username&gt;/Harmonie (push)
   public  git@hirlam.org:Harmonie (fetch)
   public  git@hirlam.org:Harmonie (push)</code></pre><p>where <em>origin</em> points to your own user repository, and <em>public</em> points to the central public repository. Instead of <code>&#39;git@hirlam.org:&#39;</code> the listing may show <code>&#39;https://git.hirlam.org/&#39;</code> in case your remotes have been established on basis of https access.</p><p>Updating of for example the <code>develop</code> branch within your fork on hirlam.org would then be done as follows: [=#updatefork]</p><pre><code class="language-bash">   cd &lt;your local user repo&gt;
   git checkout develop
   git pull public develop
   git push origin develop</code></pre><h3 id="Alternative-to-fork-1"><a class="docs-heading-anchor" href="#Alternative-to-fork-1">= Alternative to fork=</a><a class="docs-heading-anchor-permalink" href="#Alternative-to-fork-1" title="Permalink"></a></h3><p>Another alternative to forking is to establish the user repository via a clone:</p><pre><code class="language-bash">   git clone https://git.hirlam.org/Harmonie Harmonie
   git remote rename origin public
   git remote add origin https://git.hirlam.org/users/&lt;your username&gt;/Harmonie</code></pre><p>This approach, however, does perform a real copy of the public Harmonie repository without storage optimization. In this example, the original clone URL is retained in the remote alias &#39;public&#39;, making it possible to still fetch and pull updates from the public Harmonie repository.</p><p>After cloning, move into the created directory in order to start working under the repository. This cloning checks out the <code>master</code> branch of Harmonie. It reflects the official Harmonie releases, which are represented in <em>tags</em>.</p><h3 id="Direct-Cloning-1"><a class="docs-heading-anchor" href="#Direct-Cloning-1">Direct Cloning</a><a class="docs-heading-anchor-permalink" href="#Direct-Cloning-1" title="Permalink"></a></h3><p>All users of hirlam.org may also clone the Harmonie git repository via read access as follows:</p><pre><code class="language-bash">   git clone https://git.hirlam.org/Harmonie my_Harmonie</code></pre><p>Leaving out the <em>my_Harmonie</em> specification results in the local directory being called Harmonie like the original one.</p><h3 id="Branches-1"><a class="docs-heading-anchor" href="#Branches-1">Branches</a><a class="docs-heading-anchor-permalink" href="#Branches-1" title="Permalink"></a></h3><h3 id="access-1"><a class="docs-heading-anchor" href="#access-1">= access=</a><a class="docs-heading-anchor-permalink" href="#access-1" title="Permalink"></a></h3><p>In order to access the branches other than <code>master</code> within the Harmonie repository, the list of available //remote// branches can be shown using</p><pre><code class="language-bash">   git branch -a</code></pre><p>And in order to get a remote branch onto the local clone, it has to be checked out (e.g. the <code>develop</code> branch):</p><pre><code class="language-bash">   git checkout develop</code></pre><p>This creates the local represenation of the <code>develop</code> branch. This can be verified by</p><pre><code class="language-bash">   git branch</code></pre><p>which just lists the local branches, and marks the currently checked out branch.</p><blockquote><p>NOTE: In order to better facilitate that you can add official updates to your local work, it is recommended that you do not commit to <code>develop</code> branch directly, but rather branch off from there for doing development. This leaves the original branch open for easily getting updates. These updates can then be merged into your own development branch (see below). This procedure keeps possible merging conflicts away from the official branches within your local git repository</p></blockquote><h3 id="update-1"><a class="docs-heading-anchor" href="#update-1">= update=</a><a class="docs-heading-anchor-permalink" href="#update-1" title="Permalink"></a></h3><p>A branch like for example <code>develop</code> in your local repository can be updated by:</p><pre><code class="language-bash">   git checkout develop
   git pull &lt;remote&gt; develop</code></pre><p>where &#39;&lt;remote&gt;&#39; stands for either &#39;public&#39; or &#39;origin&#39;, depending on, whether you applied a [#forking fork], and how you organized your [#remotelist remotes]</p><p>and similarly for [#branches one of the future cycle branches CY&#39;nn&#39;]:</p><pre><code class="language-bash">   git checkout CY&#39;nn&#39;
   git pull &lt;remote&gt; CY&#39;nn&#39;</code></pre><h3 id="Local-Development-#localdev-1"><a class="docs-heading-anchor" href="#Local-Development-#localdev-1">Local Development #localdev</a><a class="docs-heading-anchor-permalink" href="#Local-Development-#localdev-1" title="Permalink"></a></h3><h3 id="create-feature-branches-1"><a class="docs-heading-anchor" href="#create-feature-branches-1">= create feature branches=</a><a class="docs-heading-anchor-permalink" href="#create-feature-branches-1" title="Permalink"></a></h3><p>In order to do own development work, it is best practice to create a //feature branch// by branching-off from the desired official development branch. This would be branch <code>develop</code> or [#branches one of the future cycle branches CY&#39;nn&#39;]. For a cycle related feature development, this would look like:</p><pre><code class="language-bash">   git checkout CY&#39;nn&#39;
   git checkout -b cy&#39;nn&#39;_my_feature</code></pre><p>Here &#39;nn&#39; is to be replaced by the number representing the cycle. This creates the feature branch cy&#39;nn&#39;<em>my</em>feature on basis of CY&#39;nn&#39;, and checks it out for immediately facilitating to start work on it within your local Harmonie git repository.</p><p>In case your feature development is to be related to branch <code>develop</code>, then the creation of the feature branch could look like:</p><pre><code class="language-bash">   git checkout develop
   git checkout -b cy&#39;dd&#39;_my_feature</code></pre><p>After checkout of branch <code>develop</code>, this creates branch cy&#39;dd&#39;<em>my</em>feature on basis of the latest status of branch <code>develop</code> within your local Harmonie git repository. Here the cycle number &#39;dd&#39; would take the number for the cycle that is represented by branch <code>develop</code>. At the time of writing, this is cycle 43.</p><p>If you want to make sure that you don&#39;t miss the very latest official changes to <code>develop</code> before branching off, then update <code>develop</code> first, and if your local repo is cloned from your [#forking fork], then [#updatefork update your fork branch first]. Then apply the update locally and branch-off:</p><pre><code class="language-bash">   git checkout develop
   git pull origin develop
   git checkout -b cy&#39;dd&#39;_my_feature</code></pre><h3 id="update-feature-branches-#updatefeaturebranch-1"><a class="docs-heading-anchor" href="#update-feature-branches-#updatefeaturebranch-1">= update feature branches= #updatefeaturebranch</a><a class="docs-heading-anchor-permalink" href="#update-feature-branches-#updatefeaturebranch-1" title="Permalink"></a></h3><p>In case you have existing feature branches, which have been branched-off from branch <code>develop</code> or any of [#branches the other cycle development branches (CY&#39;nn&#39;)], then you should update each feature branch every time after you have updated <code>develop</code> or CY&#39;nn&#39; with changes from the public repository, respectively. Updating for example your local <code>develop</code> branch would look like (assume [#forking the forking structure]):</p><pre><code class="language-bash">   git checkout develop
   git pull public develop</code></pre><p>A feature branch can then be updated as follows:</p><pre><code class="language-bash">   git checkout cy&#39;dd&#39;_my_feature
   git merge develop</code></pre><p>The merge may result in merge conflicts, if your local feature changes conflict with upstream changes. You have to resolve the conflicts in order to finish the update, see <a href="http://git-scm.com/book/en/v2">git documantation</a> or the manual pages for details. The merge process usually creates a merge commit, unless the merge results in a simple <em>fast-forward</em>, and all feature commits you did within your feature branch are retained <strong>as is</strong></p><p>An alternative for updating your feature branch is <em>rebase</em>:</p><pre><code class="language-bash">     git checkout cy&#39;dd&#39;_my_feature
     git rebase develop</code></pre><p>Similar to merge, rebase may result in conflicts, which you have to resolve in order to finish the rebase.</p><p>The difference to merge is that rebase reapplies all your feature specific commits on top of the latest commit from <code>develop</code>. This means that a new commit is created instead of the old one for each of your feature specific commits. So in the end it may look like as if you had applied all feature specific changes first <strong>after</strong> the latest commit within branch <code>develop</code>. However, even though the <em>commit date</em> has changed for each of your feature specific commits, the <em>author date</em> is <strong>retained</strong>, still pointing to the time, when the feature commit was introduced. This means that the <em>commit date</em> marks the rebase action, whereas the <em>author date</em> marks the original introcducion of the commit.</p><blockquote><p><strong>WARNING:</strong></p></blockquote><blockquote><p>as <em>rebase</em> rewrites commit history, you should only apply it upon really local commits, that is commits, that neither have been shared nor published yet</p></blockquote><blockquote><p>once there are commits involved that have been published or shared, use <em>merge</em></p></blockquote><h3 id="Sharing-Development-#sharing-1"><a class="docs-heading-anchor" href="#Sharing-Development-#sharing-1">Sharing Development #sharing</a><a class="docs-heading-anchor-permalink" href="#Sharing-Development-#sharing-1" title="Permalink"></a></h3><h3 id="shared-user-repository-#shareduserrepo-1"><a class="docs-heading-anchor" href="#shared-user-repository-#shareduserrepo-1">= shared user repository= #shareduserrepo</a><a class="docs-heading-anchor-permalink" href="#shared-user-repository-#shareduserrepo-1" title="Permalink"></a></h3><p>The local development within your local user repository can be shared on hirlam.org via your user repository on the server. This user repository is readable for all registered users on hirlam.org, but only you have write access on it to begin with. A shared user repository is created by one of following actions:</p><p>a. by [#forking forking] from the central official repositories - this would for example apply to the Harmonie repository</p><p>b. by pushing your local repository towards hirlam.org:</p><pre><code class="language-bash">      git remote add origin git@hirlam.org:users/&lt;your username&gt;/&lt;repository name&gt;
      git push origin master</code></pre><h3 id="granting-write-access-#grantuserwrite-1"><a class="docs-heading-anchor" href="#granting-write-access-#grantuserwrite-1">= granting write access= #grantuserwrite</a><a class="docs-heading-anchor-permalink" href="#granting-write-access-#grantuserwrite-1" title="Permalink"></a></h3><p>In order to really share development, you can grant write access to each registered user on hirlam.org separately:</p><pre><code class="language-bash">  ssh git@hirlam.org perms users/&lt;your username&gt;/Harmonie + WRITERS &lt;granted username&gt;</code></pre><p>this grants write access to your user repository of Harmonie to the user that is specified by &#39;&lt;granted username&gt;&#39;.</p><blockquote><p>Note: this granted write access to other users allows for push actions into your existing user repositories, but it does not allow for creation of a new repository. If you want to give such create-permission to another user in addition, it is necessary to contact system core group (system-core at hirlam.org).</p></blockquote><p>The list of users, who have write access to your shared user repository can be viewed by:</p><pre><code class="language-bash">  ssh git@hirlam.org perms -l users/&lt;your username&gt;/Harmonie</code></pre><p>This granted write access can also be revoked by you at any time:</p><pre><code class="language-bash">  ssh git@hirlam.org perms users/&lt;your username&gt;/Harmonie - WRITERS &lt;granted username&gt;</code></pre><p>Note the tiny difference of <strong>+</strong> and <strong>-</strong> in the syntax.</p><blockquote><p>Note: the ssh commands for granting write access to your shared user repository are not available, unless your public ssh key is registered for &#39;git&#39; on hirlam.org. Please contact the system core group and provide your public key for registration.</p></blockquote><p>.</p><h3 id="setting-up-//remotes//-for-sharing-1"><a class="docs-heading-anchor" href="#setting-up-//remotes//-for-sharing-1">= setting up //remotes// for sharing=</a><a class="docs-heading-anchor-permalink" href="#setting-up-//remotes//-for-sharing-1" title="Permalink"></a></h3><p>In order to make sharing of development easier, following //remotes// can be established:</p><table><tr><th style="text-align: right"><strong>//remote//</strong></th><th style="text-align: right"><strong>description</strong></th></tr><tr><td style="text-align: right">origin</td><td style="text-align: right">remote link to your own user repository - this exists already, if you [#forkclone cloned form your fork]</td></tr><tr><td style="text-align: right">&lt;sharing user&gt;</td><td style="text-align: right">remote link to the user repository of a user who shares his/her work with you</td></tr></table><p>the latter of these two //remotes// is established (for Harmonie repository) as follows:</p><pre><code class="language-bash">  git remote add &lt;sharing user&gt; git@hirlam.org:users/&lt;sharing user&gt;/Harmonie</code></pre><blockquote><p>[[Color(red, BUG)]]: currently the users you share with might have to access your user repository using&gt;  {{{   https://git.hirlam.org/users/&lt;sharing user&gt;/Harmonie }}} instead of {{{   git@hirlam.org:users/&lt;sharing user&gt;/Harmonie }}}</p></blockquote><p>Once this is established, sharing is possible in two different ways by use of these //remotes//:</p><p>a. if the shared repository is located within your own user repository on hirlam.org</p><ul><li>receiving updates of <code>our_feature</code> from your own user repository, after it was updated by the sharing user</li></ul><pre><code class="language-bash">       git checkout our_feature
       git pull origin our_feature</code></pre><ul><li>sending updates of <code>our_feature</code> to your own user repository, for sharing</li></ul><pre><code class="language-bash">       git checkout our_feature
       git push origin our_feature</code></pre><p>b. if the shared repository is located within the other user&#39;s user repository on hirlam.org</p><ul><li>established the shared branch locally</li></ul><pre><code class="language-bash">       git fetch &lt;sharing user&gt;
       git checkout -b our_feature --track &lt;sharing user&gt;/our_feature</code></pre><ul><li>receiving updates of <code>our_feature</code> from the other users&#39; user repository</li></ul><pre><code class="language-bash">       git checkout our_feature
       git pull &lt;sharing user&gt; our_feature</code></pre><ul><li>sending updates of <code>our_feature</code> directly to the sharing user&#39;s repository (necessitates that the sharing user [#grantuserwrite grants write permission] to you)</li></ul><pre><code class="language-bash">       git checkout our_feature
       git push &lt;sharing user&gt; our_feature</code></pre><h3 id="recommended-working-practice-1"><a class="docs-heading-anchor" href="#recommended-working-practice-1">= recommended working practice=</a><a class="docs-heading-anchor-permalink" href="#recommended-working-practice-1" title="Permalink"></a></h3><p>In order to be able to share developments with a minimum of conflicts, it is recommended to make use of branching similar as done for any [#localdev local developments]. So</p><p>This means, that</p><blockquote><p>do not commit directly onto the shared branch, but branch-off from it in order to do any local work</p></blockquote><p>This should be always valid, also if your shared branch is a feature branch, which is branched of from <code>develop</code>. The fact that another user keeps a local clone of your feature branch, thus sharing that feature branch with you, makes it necessary to keep this branch in a state where it can be updated <em>at any time</em>, regardless of the current status of your local work on that feature.</p><p>This <em>branch-off</em> working practice establishes a hierarchy of branches, which is one of the central concepts of the underlying git work flow.</p><h3 id="Publishing-Development-1"><a class="docs-heading-anchor" href="#Publishing-Development-1">Publishing Development</a><a class="docs-heading-anchor-permalink" href="#Publishing-Development-1" title="Permalink"></a></h3><p>In order for a development to become officially public on the central public Harmonie repository, the commits related to that development have to be pushed to the central public repository.</p><blockquote><p>NOTE: only system-core staff have write access to the central public Harmonie repository. You have to contact a system-core staff memeber for adding commits, that you consider mature enough to be added to the official branch.</p></blockquote><p>So instead of directly pushing to the central public Harmonie repository, following procedure applies:</p><ol><li><p>Let&#39;s assume that:</p><ul><li><p>you make use of your own [#forking user repository fork]</p></li><li><p>the relevant commits, are placed within an exclusive feature branch, which is branched-off from branch <code>develop</code>, so the feature branch only contains the relevant commits in addition to those that stem from <code>develop</code></p></li></ul></li></ol><ol><li>make sure the feature branch including the new development is mature for publishing</li></ol><ol><li><p>update the feature branch to include the latest official upstream changes under <code>develop</code> from the central public repository:</p><ul><li>update <code>develop</code> locally and on your user repository</li></ul></li></ol><pre><code class="language-bash">        git checkout develop
        git pull public develop
        git push origin develop</code></pre><ul><li>merge the upstream changes into your feature branch</li></ul><pre><code class="language-bash">        git checkout &lt;feature branch&gt;
        git merge develop</code></pre><pre><code class="language-none"> and resolve possible conflicts (&lt;feature branch&gt; is a placeholder fo the branch name). The risk for conflicts at this stage is minimized, if you have [#updatefeaturebranch updated the feature branch] regularly

* [#sharing share] your feature branch via your user repository</code></pre><pre><code class="language-bash">        git push origin &lt;feature branch&gt;</code></pre><ol><li><p>notify the system core group (system-core at hirlam.org) and request them to pull from your feature branch into the central public branch <code>develop</code>. The request should provide following information:</p><ul><li><p>the name of your feature branch</p></li><li><p>indication on whether to gather the feature commits into a single one (squashing into one commit)</p></li></ul><p>The system-core group will likely include your feature commits by <em>rebasing</em> them, in order to clear history for many merge commits, and this will create a new commit history for the feature. However, your original author information including the original author date is still retained.</p></li><li><p>after system-core has published your feature on the public <code>develop</code> branch, you can update your local <code>develop</code> branch, as well as on your user repository:</p></li></ol><pre><code class="language-bash">        git checkout develop
        git pull public develop
        git push origin develop</code></pre><pre><code class="language-none">so now your have gotten your feature back in its published form, and your own feature branch has become obsolete.</code></pre><ol><li>delete your feature branch in order to avoid any confusion in the future (we assume that your feature branch has no other extra commits than those that have been published). Remove it both locally and on your user repository at hirlam.org:</li></ol><pre><code class="language-bash">        git branch -D &lt;feature branch&gt;
        git push origin :&lt;feature branch&gt;</code></pre><hr/><h2 id="Repository-Structure-1"><a class="docs-heading-anchor" href="#Repository-Structure-1">Repository Structure</a><a class="docs-heading-anchor-permalink" href="#Repository-Structure-1" title="Permalink"></a></h2><h3 id="Branches-#branches-1"><a class="docs-heading-anchor" href="#Branches-#branches-1">Branches #branches</a><a class="docs-heading-anchor-permalink" href="#Branches-#branches-1" title="Permalink"></a></h3><p>The repository structure is basically designed around the <a href="https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow">git-flow</a> ideas, without reflecting it completely. The publicly available Harmonie git repository contains following branches:</p><p>master::    the harmonie branch for ready releases, HEAD points to latest official release</p><p>develop::    the general harmonie development branch (reflects mostly the role of the old svn trunk)</p><ul><li></li></ul><p>CY&#39;nn&#39;::    major development branch for cycle &#39;nn&#39;</p><ul><li></li></ul><p>Branching hierarchy is such that there is one major development branch for each future cycle, and branch <code>develop</code> is the ultimate development line, which reflects the development of the currently official Harmonie cycle, and from which all the future cycle branches CY&#39;nn&#39; are to be branched off.</p><p>Currently, <code>develop</code> reflects the cycle 43 development, so there is no extra CY43 branch. The previously existing CY43 branch has been <a href="../DevelopmentMerge/CY43/">merged into <code>develop</code></a>. All history from CY43 has thus entered into <code>develop</code>.</p><p>For future cycles like for example cycle 46, a branch called CY46 is established. It is going to exist until merged into <code>develop</code>.</p><p>Any feature development would be meant to branch off from:</p><ul><li>the <code>develop</code> cycle, if the feature relates to the cycle that branch <code>develop</code> represents</li><li>CY&#39;nn&#39;, if the feature relates to cycle &#39;nn&#39;</li></ul><p>Each feature branch is supposed to be updated by the branch, from which it was branched off, and to be merged back into that same branch, once the feature is finished.</p><h3 id="Tags-1"><a class="docs-heading-anchor" href="#Tags-1">Tags</a><a class="docs-heading-anchor-permalink" href="#Tags-1" title="Permalink"></a></h3><p>The tags in the Harmonie git repository may originate</p><ul><li>from the <strong>arpifs</strong> code repository of Meteo France, where they follow the conventions of Meteo France git repository</li><li>from  Harmonie itself, where they are used to mark releases or other potentially important snapshots. Release tags usually start with prefix &quot;release-&quot; (see below)</li></ul><p>Following tag prefix conventions are used in the Harmonie git repository:</p><p>release-::     identifies a release   end-::     identifies the end of a cycle within commit history. The cycle number appears after the prefix. Doing a hard reset to this tag allows to get to that snapshot easily.   merge-::     identifies the point in commit history, at which the cycle indicated by the number that follows the prefix has been merged into the develop branch.</p><h2 id="From-svn-to-git-1"><a class="docs-heading-anchor" href="#From-svn-to-git-1">From svn to git</a><a class="docs-heading-anchor-permalink" href="#From-svn-to-git-1" title="Permalink"></a></h2><p>The motivations for migration from svn revision control to git revision control are not discussed here. Instead, following sketch provides aspects about the procedure of <em>how</em> migration is done:</p><ul><li>following svn branches are migrated to git<ol><li>those parts from major development branch <strong>trunk</strong>, which refer to Harmonie<ul><li>the history of the Harmonie trunk commits is retained in the git repository as much as possible</li><li>the new name for this branch is <em>develop</em></li></ul></li><li>cycle 43 svn branches that reflect the major development for cycle 43, are gathered into one branch<ul><li>the new name for this branch is CY43</li></ul></li></ol></li></ul><ul><li>svn tags are no longer independend branches, they are now embedded as real tags with the development branches</li></ul><h3 id="Date-informations-1"><a class="docs-heading-anchor" href="#Date-informations-1">Date informations</a><a class="docs-heading-anchor-permalink" href="#Date-informations-1" title="Permalink"></a></h3><p>committer dates::</p><ul><li>reflect the <em>original</em> committer date in case of an original arpifs commit (these <em>original</em> committer dates are those dates when arpifs was converted to git</li><li>reflect an artificial committing date in case of commits from svn trunk, in order to better fit them into the timeline of arpifs commits</li></ul><p>author dates::</p><ul><li>reflect the <em>original</em> author date in case of an original arpifs commit (these <em>original</em> author dates are those dates when arpifs was converted to git</li><li>reflect the original commit date in case of an svn commit</li></ul><p>So the author dates are the really important dates for those commits that stem from svn.</p><h3 id="Specific-circumstances-1"><a class="docs-heading-anchor" href="#Specific-circumstances-1">Specific circumstances</a><a class="docs-heading-anchor-permalink" href="#Specific-circumstances-1" title="Permalink"></a></h3><p>There are some things from the svn workflow, that become different with the git repo:</p><ol><li><p>The svn barnches harmonie-43t1, harmonie-43t2 and harmonie-43h1.pre-alpha.1 develeopments have been collapsed to the cy43 development branch CY43</p></li><li><p>In svn the release tags where independend branches, and there are tag specific svn commmits to adapt for example the &quot;Default_release&quot; setting in the config-sh/Harmonie script. These adaptations have never entered the trunk in svn. Under git, where we have the master branch for the releases, I have added these tag specific commits at the point of the release, and created a new tag.</p></li></ol><p>This has been done back in history for following releases:</p><table><tr><th style="text-align: right">svn tag branch</th><th style="text-align: right">git release tag</th></tr><tr><td style="text-align: right">harmonie-38h1.1</td><td style="text-align: right">release-38h1.1</td></tr><tr><td style="text-align: right">harmonie-40h1.1</td><td style="text-align: right">release-40h1.1</td></tr></table><p>Here the prefix <em>release-</em> is put in front in the git repo, to make them easier to find in the long list of tags.</p><p>So these two releases should be fully reproducable from the git repo by making use of the git release tag.</p><p>The svn tag names also still exist, where the svn-git converter has put them, but they don&#39;t reflect the svn tag code to 100%.  These svn tags should probably be removed from the git history in order to clear things up.</p><h3 id="Modified-History-1"><a class="docs-heading-anchor" href="#Modified-History-1">Modified History</a><a class="docs-heading-anchor-permalink" href="#Modified-History-1" title="Permalink"></a></h3><p>The history of the svn trunk that concerns Harmonie, could not be taken over to git <em>as is</em>. Some svn commits had to be ommitted or where squashed together in order to retain full history within git, or in order to simplify a merge.</p><p>On the other hand, merge commits are added into the git history in order to connect history to the <strong>arpifs</strong> code repository. These commits can be identified via the commit message by the leading entry</p><pre><code class="language-bash">mp NN: set merge point</code></pre><p>where &#39;NN&#39; is a moving number.</p><p>An example of an omitted svn commit is &#39;r15152&#39;. Including this into git history would breack the <em>continuous thread</em> of history for each removed file, which would restrict the usability of for example <strong>git blame</strong>. Instead &#39;r15154&#39; reflects the full merge:</p><pre><code class="language-bash">2615591095a96b9a78faf334d971d31188f877d0  2016-08-29 07:51:46 +0000   Load c43t1 source.  (cy43t1)</code></pre><p>Note also the tag cy43t1, that reflects the development w.r.t. <em>&#39;arpifs</em>.</p><p>And example of squashed svn commits are &#39;r17136, r17137, r17138, r17139, r17140&#39;, which appear under git as:</p><pre><code class="language-bash">7a401b680ca730e4b74c8d2d8604ab59b1132d22  2018-05-25 13:48:57 +0000  Merge trunk/src/arpifs/control.  (43h1.pre-alpha.1)</code></pre><hr/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../HarmonieTestbed/">« Testbed</a><a class="docs-footer-nextpage" href="../ECMWF_teleport/">Teleport »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 19 October 2021 09:36">Tuesday 19 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
